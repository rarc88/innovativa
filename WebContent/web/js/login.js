var isRecBrowserMsgShown=false;function setLoginMessage(d,f,e){if(d==="Error"){var c=document.getElementById("errorMsg");var a=document.getElementById("errorMsgTitle");var h=document.getElementById("errorMsgTitle_Container");var b=document.getElementById("errorMsgContent");if(typeof f!=="undefined"&&f!==""&&f!==null){a.innerHTML=f.replace(/\n/g,"<br>").replace(/\\n/g,"<br>");
h.style.display="";}else{a.innerHTML="";h.style.display="none";}if(typeof e!=="undefined"&&e!==""&&e!==null){b.innerHTML=e.replace(/\n/g,"<br>").replace(/\\n/g,"<br>");}else{b.innerHTML="";}c.style.display="";isRecBrowserMsgShown=false;return false;}else{if(d==="Warning"||d==="Confirmation"){var g="";
if(typeof f!=="undefined"&&f!==""&&f!==null){g+=f.replace(/<br>/g,"\n")+"\n";}if(typeof e!=="undefined"&&e!==""&&e!==null){g+=e.replace(/<br>/g,"\n");}if(d==="Warning"){alert(g);return true;}else{return confirm(g);}}}}function doLogin(a){var b;if(document.getElementById("resetPassword").value==="true"&&document.getElementById("user").value!==document.getElementById("password").value){setLoginMessage("Error",errorSamePassword,errorDifferentPasswordInFields);
return true;}if(focusedWindowElement.id==="user"&&document.getElementById("user").value!==""&&document.getElementById("password").value===""){setTimeout(function(){if(focusedWindowElement.id==="user"&&document.getElementById("password").value===""){setWindowElementFocus(document.getElementById("password"));
}else{return true;}},10);}else{if(focusedWindowElement.id==="password"&&document.getElementById("password").value!==""&&document.getElementById("user").value===""){setWindowElementFocus(document.getElementById("user"));}else{if(document.getElementById("user").value===""||document.getElementById("password").value===""){setLoginMessage("Error",identificationFailureTitle,errorEmptyContent);
return true;}disableButton("buttonOK");a=a||(document.getElementById("resetPassword").value==="true"?"FORCE_RESET_PASSWORD":"DEFAULT");b="&targetQueryString="+getURLQueryString();submitXmlHttpRequest(loginResult,document.frmIdentificacion,a,"../secureApp/LoginHandler.html",false,b,null);}}return false;
}function getURLQueryString(){return encodeURIComponent(window.location.search.substr(1));}function loginResult(c,d){var b="";if(getReadyStateHandler(d,null,false)){if(d.responseText){b=d.responseText;}b=b.toString();var a=JSON.parse(b);processResult(a);}}function processResult(a){var c="_self",d,b=true;
if(a.showMessage){b=setLoginMessage(a.messageType,a.messageTitle,a.messageText);if(!b){document.getElementById("password").value="";}}if(a.resetPassword){document.getElementById("resetPassword").value=a.resetPassword;document.getElementById("user").value="";document.getElementById("user").type="password";
document.getElementById("userlabel").style.display="none";document.getElementById("passwordlabel").style.display="none";document.getElementById("newpasswordlabel").style.display="";document.getElementById("confirmpasswordlabel").style.display="";}if(b){if(a.showMessage&&a.messageType==="Confirmation"){doLogin(a.command);
}else{window.location=a.target;}}else{if(a.resetPassword){enableButton("buttonOK");document.getElementById("user").value="";setWindowElementFocus("user","id");}else{enableButton("buttonOK");setWindowElementFocus("password","id");}}}function redirectWhenPopup(){var a=false;try{if(top.opener.parent.frames["appFrame"]){a=true;
}}catch(b){}if(a&&top.opener){top.opener.parent.location.href=top.document.location.href;top.window.close();}}function redirectWhenInsideMDI(){if(typeof isWindowInMDIPage!=="undefined"&&isWindowInMDIPage){var a=null;if(isWindowInMDIPopup&&parent.opener){a=parent.opener.getFrame("LayoutMDI");}else{a=getFrame("LayoutMDI");
}if(a&&typeof parent.document.getElementById("framesetMenu")==="object"){a.location.href=location.href||parent.window.location.href;}}}function manageVisualPreferences(){var b=document.getElementById("TopLogos_Container");var a=document.getElementById("BottomLogos_Container");if(showSupportLogo&&showForgeLogo){b.className="Login_TopLogos_Container_Support_Forge";
}else{if(showSupportLogo){b.className="Login_TopLogos_Container_Support";}else{if(showForgeLogo){b.className="Login_TopLogos_Container_Forge";}else{b.className="Login_TopLogos_Container_None";}}}if(showCompanyLogo&&urlCompany!==""){document.getElementById("CompanyLogo_Container").innerHTML='<a href="'+urlCompany+'" target="_blank" class="Login_Img_Link">'+document.getElementById("CompanyLogo_Container").innerHTML+"</a>";
}if(showSupportLogo&&urlSupport!==""){document.getElementById("SupportLogo_Container").innerHTML='<a href="'+urlSupport+'" target="_blank" class="Login_Img_Link">'+document.getElementById("SupportLogo_Container").innerHTML+"</a>";}if(showForgeLogo&&urlForge!==""){document.getElementById("ForgeLogo_Container").innerHTML='<a href="'+urlForge+'" target="_blank" class="Login_Img_Link">'+document.getElementById("ForgeLogo_Container").innerHTML+"</a>";
}if(showCompanyLogo){document.getElementById("CompanyLogo_Container").style.display="";}b.style.display="";a.style.display="";}function maskLoginWindow(c){var b=document.getElementById("client");var a=document.getElementById("blocker");a.innerHTML='<div class="Login_Home_Logo_Icon"></div><div class="error-text">'+c+"</div>";
a.style.display="";b.style.display="none";}function browserVersionToFloat(a){while(a.indexOf(".")!==a.lastIndexOf(".")){a=a.substring(0,a.lastIndexOf("."))+a.substring(a.lastIndexOf(".")+1,a.length);}a=parseFloat(a,10);return a;}function browserVersionTrim(a){while((a.substring(a.length-1,a.length)==="0"&&a.indexOf(".")!==-1)||a.substring(a.length-1,a.length)==="."){a=a.substring(0,a.length-1);
}return a;}function checkBrowserCompatibility(){var d=getBrowserInfo("name");var a=getBrowserInfo("version");var b=getBrowserInfo("majorVersion");var c=false;if(d.toUpperCase().indexOf("FIREFOX")!=-1||d.toUpperCase().indexOf("ICEWEASEL")!=-1){if(browserVersionToFloat(a)>=browserVersionToFloat(validBrowserFirefox)){c=true;
}}else{if(d.toUpperCase().indexOf("INTERNET EXPLORER")!=-1){if(browserVersionToFloat(a)>=browserVersionToFloat(validBrowserExplorer)){c=true;}}else{if(d.toUpperCase().indexOf("GOOGLE CHROME")!=-1){if(browserVersionToFloat(a)>=browserVersionToFloat(validBrowserChrome)){c=true;}}else{if(d.toUpperCase().indexOf("APPLE SAFARI")!=-1){if(browserVersionToFloat(a)>=browserVersionToFloat(validBrowserSafari)){c=true;
}}else{if(d.toUpperCase().indexOf("MICROSOFT EDGE")!=-1){if(browserVersionToFloat(a)>=browserVersionToFloat(validBrowserEdge)){c=true;}}}}}}return c;}function checkRecommendedBrowser(){var c=getBrowserInfo("name");var a=getBrowserInfo("version");var b=getBrowserInfo("majorVersion");var d=false;if(c.toUpperCase().indexOf("FIREFOX")!=-1||c.toUpperCase().indexOf("ICEWEASEL")!=-1){if(browserVersionToFloat(a)>=browserVersionToFloat(recBrowserFirefox)){d=true;
}}else{if(c.toUpperCase().indexOf("INTERNET EXPLORER")!=-1){if(browserVersionToFloat(a)>=browserVersionToFloat(recBrowserExplorer)){d=true;}}else{if(c.toUpperCase().indexOf("GOOGLE CHROME")!=-1){if(browserVersionToFloat(a)>=browserVersionToFloat(recBrowserChrome)){d=true;}}else{if(c.toUpperCase().indexOf("APPLE SAFARI")!=-1){if(browserVersionToFloat(a)>=browserVersionToFloat(recBrowserSafari)){d=true;
}}else{if(c.toUpperCase().indexOf("MICROSOFT EDGE")!=-1){if(browserVersionToFloat(a)>=browserVersionToFloat(recBrowserEdge)){d=true;}}}}}}return d;}function buildValidBrowserMsg(){var a=validBrowserMsg;a=a+"<br>"+" * Mozilla Firefox "+browserVersionTrim(validBrowserFirefox)+" "+validBrowserMsgOrHigher+"<br>"+" * Google Chrome "+browserVersionTrim(validBrowserChrome)+" "+validBrowserMsgOrHigher+"<br>"+" * Microsoft Internet Explorer "+browserVersionTrim(validBrowserExplorer)+" "+validBrowserMsgOrHigher+"<br>"+" * Microsoft Edge "+browserVersionTrim(validBrowserEdge)+" "+validBrowserMsgOrHigher+"<br>"+" * Apple Safari "+browserVersionTrim(validBrowserSafari)+" "+validBrowserMsgOrHigher;
return a;}function buildRecBrowserMsgText(){var a=recBrowserMsgText;a=a.replace("XX","Google Chrome "+browserVersionTrim(recBrowserChrome)+", Mozilla Firefox "+browserVersionTrim(recBrowserFirefox)+", Internet Explorer "+browserVersionTrim(recBrowserExplorer)+", Microsoft Edge "+browserVersionTrim(recBrowserEdge));
a=a.replace("YY","Apple Safari "+browserVersionTrim(recBrowserSafari)+"");return a;}function addInputChangeCheck(a){setObjAttribute(a,"onkeypress","checkInputKeyDown(this); return true;");setObjAttribute(a,"oncut","checkInputKeyDown(this); return true;");setObjAttribute(a,"oncopy","checkInputKeyDown(this); return true;");
setObjAttribute(a,"onpaste","checkInputKeyDown(this); return true;");}function setRecommendedBrowserMessage(e,d){var c=document.getElementById("errorMsg");var a=document.getElementById("errorMsgTitle");var b=document.getElementById("errorMsgContent");a.innerHTML="";if(typeof e!=="undefined"&&e!==""&&e!==null){b.innerHTML='<span class="Login_RecBrowserMsg_Title">'+e.replace(/\n/g,"<br>").replace(/\\n/g,"<br>")+": "+"</span>";
}else{b.innerHTML="";}if(typeof d!=="undefined"&&d!==""&&d!==null){b.innerHTML=b.innerHTML+'<span class="Login_RecBrowserMsg_Content">'+d.replace(/\n/g,"<br>").replace(/\\n/g,"<br>")+"</span>";}c.style.display="";isRecBrowserMsgShown=true;}function resetLoginMessage(){var c=document.getElementById("errorMsg");
var a=document.getElementById("errorMsgTitle");var d=document.getElementById("errorMsgTitle_Container");var b=document.getElementById("errorMsgContent");a.innerHTML="";d.style.display="";b.innerHTML="";c.style.display="none";isRecBrowserMsgShown=false;}function checkInputKeyDown(a,c){var b=document.getElementById("errorMsg");
if(b.style.display!=="none"&&typeof a==="object"){if(typeof c==="undefined"||c===null){c=a.value.length;setTimeout(function(){checkInputKeyDown(a,c);},100);}else{if(c!==a.value.length&&!isRecBrowserMsgShown){resetLoginMessage();}}}return true;}function beforeLoadDo(){redirectWhenPopup();redirectWhenInsideMDI();
}function onLoadDo(){var d=document.getElementById("errorMsg");var a=document.getElementById("errorMsgTitle");var h=document.getElementById("errorMsgTitle_Container");var c=document.getElementById("errorMsgContent");if(a.innerHTML.length===0){h.style.display="none";}try{manageVisualPreferences();addInputChangeCheck(document.getElementById("user"));
addInputChangeCheck(document.getElementById("password"));this.windowTables=new Array(new windowTableId("client","buttonOK"));setWindowTableParentElement();enableEditionShortcuts();setWindowElementFocus("user","id");}catch(f){}if((!revisionControl(currentRevision))||(isOpsInstance()!=isOpsInstanceCached())){maskLoginWindow(cacheMsg);
setLoginMessage("Warning","",cacheMsg);}if(!checkBrowserCompatibility()){var b=buildValidBrowserMsg();setLoginMessage("Warning","",b);}if(!checkRecommendedBrowser()&&a.innerHTML.length===0&&c.innerHTML.length===0){var g=buildRecBrowserMsgText();setRecommendedBrowserMessage(recBrowserMsgTitle,g);}if(expirationMessage){setLoginMessage(expirationMessage.type,expirationMessage.title,expirationMessage.text);
if(expirationMessage.disableLogin){disableButton("buttonOK");document.frmIdentificacion.user.disabled=true;document.frmIdentificacion.password.disabled=true;}}}function enableEditionShortcuts(){try{this.keyArray=new Array();getEditionShortcuts("applicationCommonKeys");getEditionShortcuts("windowCommonKeys");
getEditionShortcuts("editionSpecificKeys");getEditionShortcuts("genericTreeKeys");enableDefaultAction();}catch(a){}keyDownManagement();keyUpManagement();}function getEditionShortcuts(d){if(d==null||d==""||d=="null"){return;}else{if(d=="applicationCommonKeys"){if(!isWindowInMDIContext){this.keyArray.splice(keyArray.length-1,0,new keyArrayItem("M","executeMenuButton('buttonExpand');executeMenuButton('buttonCollapse');",null,"ctrlKey+shiftKey",false,"onkeydown"),new keyArrayItem("U","executeMenuButton('buttonUserOptions');",null,"ctrlKey",false,"onkeydown"),new keyArrayItem("Q","executeMenuButton('buttonQuit');",null,"ctrlKey",false,"onkeydown"),new keyArrayItem("F8","executeMenuButton('buttonAlerts');",null,null,false,"onkeydown"),new keyArrayItem("F9","menuShowHide();",null,null,false,"onkeydown"),new keyArrayItem("I","executeWindowButton('buttonAbout');",null,"ctrlKey",false,"onkeydown"),new keyArrayItem("H","executeWindowButton('buttonHelp');",null,"ctrlKey",false,"onkeydown"),new keyArrayItem("R","executeWindowButton('buttonRefresh');",null,"ctrlKey",false,"onkeydown"),new keyArrayItem("BACKSPACE","executeWindowButton('buttonBack');",null,"ctrlKey+shiftKey",false,"onkeydown"));
}else{var a=getFrame("LayoutMDI");if(typeof a.OB.Layout.ClassicOBCompatibility.Keyboard==="object"&&typeof a.OB.Layout.ClassicOBCompatibility.Keyboard.getMDIKS==="function"){var b=a.OB.Layout.ClassicOBCompatibility.Keyboard.getMDIKS();for(var c=0;c<b.length;c++){this.keyArray.splice(keyArray.length-1,0,new keyArrayItem(b[c].key,[b[c].action,b[c].funcParam],null,b[c].auxKey,false,"onkeydown"));
}}}}else{if(d=="windowCommonKeys"){this.keyArray.splice(keyArray.length-1,0,new keyArrayItem("M","putFocusOnMenu();",null,"ctrlKey",false,"onkeydown"),new keyArrayItem("F10","swichSelectedArea();",null,null,false,"onkeydown"),new keyArrayItem("N","executeWindowButton('linkButtonNew',true);",null,"ctrlKey",false,"onkeydown"),new keyArrayItem("N","executeWindowButton('linkButtonSave_Next',true);",null,"ctrlKey+shiftKey",false,"onkeydown"),new keyArrayItem("G","executeWindowButton('linkButtonSave_Relation',true);",null,"ctrlKey+shiftKey",false,"onkeydown"),new keyArrayItem("S","executeWindowButton('linkButtonSave',true);",null,"ctrlKey",false,"onkeydown"),new keyArrayItem("S","executeWindowButton('linkButtonSave_New',true);",null,"ctrlKey+shiftKey",false,"onkeydown"),new keyArrayItem("D","executeWindowButton('linkButtonDelete');",null,"ctrlKey",false,"onkeydown"),new keyArrayItem("Z","executeWindowButton('linkButtonUndo');",null,"ctrlKey",false,"onkeydown"),new keyArrayItem("A","executeWindowButton('linkButtonAttachment');",null,"ctrlKey",false,"onkeydown"),new keyArrayItem("F","executeWindowButton('linkButtonSearch');executeWindowButton('linkButtonSearchFiltered');",null,"ctrlKey",false,"onkeydown"),new keyArrayItem("HOME","executeWindowButton('linkButtonFirst',true);",null,"ctrlKey",false,"onkeydown"),new keyArrayItem("END","executeWindowButton('linkButtonLast',true);",null,"ctrlKey",false,"onkeydown"),new keyArrayItem("LEFTARROW","executeWindowButton('linkButtonPrevious',true);",null,"ctrlKey",false,"onkeydown"),new keyArrayItem("RIGHTARROW","executeWindowButton('linkButtonNext',true);",null,"ctrlKey",false,"onkeydown"),new keyArrayItem("L","executeWindowButton('linkButtonRelatedInfo');",null,"ctrlKey",false,"onkeydown"));
}else{if(d=="editionSpecificKeys"){this.keyArray.splice(keyArray.length-1,0,new keyArrayItem("TAB","windowTabKey(true);",null,null,false,"onkeydown"),new keyArrayItem("TAB","windowTabKey(false);",null,null,false,"onkeyup"),new keyArrayItem("TAB","windowShiftTabKey(true);",null,"shiftKey",false,"onkeydown"),new keyArrayItem("TAB","windowShiftTabKey(false);",null,"shiftKey",false,"onkeyup"),new keyArrayItem("ENTER","windowCtrlShiftEnterKey();",null,"ctrlKey+shiftKey",false,"onkeydown"),new keyArrayItem("ENTER","windowCtrlEnterKey();",null,"ctrlKey",true,"onkeydown"),new keyArrayItem("ENTER","windowEnterKey();",null,null,true,"onkeydown"),new keyArrayItem("G","executeWindowButton('buttonRelation');",null,"ctrlKey",false,"onkeydown"));
}else{if(d=="genericTreeKeys"){this.keyArray.splice(keyArray.length-1,0,new keyArrayItem("UPARROW","windowUpKey();",null,null,true,"onkeydown"),new keyArrayItem("RIGHTARROW","windowRightKey();",null,null,true,"onkeydown"),new keyArrayItem("DOWNARROW","windowDownKey();",null,null,true,"onkeydown"),new keyArrayItem("LEFTARROW","windowLeftKey();",null,null,true,"onkeydown"),new keyArrayItem("SPACE","windowSpaceKey();",null,null,true,"onkeydown"));
}}}}}}function disableButton(c){var a=null;try{a=document.getElementById(c);if(a.className.indexOf("ButtonLink")!=-1&&a.className.indexOf("ButtonLink_disabled")==-1){a.className=a.className.replace("ButtonLink_default","ButtonLink");a.className=a.className.replace("ButtonLink_focus","ButtonLink");a.className=a.className.replace("ButtonLink","ButtonLink_disabled");
a.setAttribute("id",a.getAttribute("id")+"_disabled");a.disabled=true;disableAttributeWithFunction(a,"obj","onclick");}}catch(b){return false;}return true;}function enableButton(c){var a=null;try{a=document.getElementById(c+"_disabled");if(a.className.indexOf("ButtonLink_disabled")!=-1){a.className=a.className.replace("ButtonLink_disabled","ButtonLink");
a.setAttribute("id",a.getAttribute("id").replace("_disabled",""));a.disabled=false;enableAttributeWithFunction(a,"obj","onclick");}}catch(b){return false;}activateDefaultAction();return true;}function disableAttributeWithFunction(a,b,c){if(b=="obj"){var d=a;}if(b=="id"){var d=document.getElementById(a);
}var e=getObjAttribute(d,c);e="return true; tmp_water_mark; "+e;setObjAttribute(d,c,e);}function enableAttributeWithFunction(a,b,c){if(b=="obj"){var d=a;}if(b=="id"){var d=document.getElementById(a);}var e=getObjAttribute(d,c);e=e.replace("return true; tmp_water_mark; ","");setObjAttribute(d,c,e);}function submitXmlHttpRequest(k,p,a,f,b,l,m){var d=null;
d=getXMLHttpRequest();if(p===null){p=document.forms[0];}if(b===null){b=false;}if(f===null){f=p.action;}if(!d){alert("Your browser doesn't support this technology");return false;}var h="Command="+encodeURIComponent(a);h+="&IsAjaxCall=1";var c=p.elements.length;for(var g=0;g<c;g++){if(p.elements[g].type){var n=inputValueForms(p.elements[g].name,p.elements[g]);
if(n&&n.indexOf("=")!==0){h+="&"+n;}}}if(l!==null&&l!==""&&l!=="null"){h+=l;}if(b){if(!debugXmlHttpRequest(a)){return false;}}d.open("POST",f);try{d.setRequestHeader("Content-Type","application/x-www-form-urlencoded");}catch(j){}var o=m;d.onreadystatechange=function(){return k(o,d);};d.send(h);return true;
}function getXMLHttpRequest(){var a=null;try{a=new XMLHttpRequest();}catch(c){a=false;}if(window.ActiveXObject){try{a=new ActiveXObject("Msxml2.XMLHTTP");}catch(d){try{a=new ActiveXObject("Microsoft.XMLHTTP");}catch(b){a=false;}}}return a;}function getReadyStateHandler(c,b,a){if(c===null){return false;
}if(a===null||typeof a==="undefined"){a=true;}if(c.readyState==4){if(c.status==200){return true;}else{if(a){alert("HTTP error "+c.status+": "+c.statusText);}return false;}return false;}return false;}