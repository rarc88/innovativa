<?xml version="1.0"?>
  <database name="VIEW SFB_BUDGET_CERT_LINE_DET_V">
    <view name="SFB_BUDGET_CERT_LINE_DET_V"><![CDATA[SELECT get_uuid() AS sfb_budget_cert_line_det_v_id, COALESCE(col.ad_client_id, cil.ad_client_id) AS ad_client_id, COALESCE(col.ad_org_id, cil.ad_org_id) AS ad_org_id, COALESCE(col.created, cil.created) AS created, COALESCE(col.createdby, cil.createdby) AS createdby, COALESCE(col.updated, cil.updated) AS updated, COALESCE(col.updatedby, cil.updatedby) AS updatedby, COALESCE(col.isactive, cil.isactive) AS isactive, COALESCE(col.em_sfb_budget_cert_line_id, cil.em_sfb_budget_cert_line_id) AS em_sfb_budget_cert_line_id, col.c_orderline_id, co.c_order_id, co.c_bpartner_id AS c_bpartner_ord_id, co.c_currency_id AS c_currency_ord_id, CASE WHEN COALESCE(dt.isreversal, 'N') = 'Y' OR COALESCE(dt.docbasetype, 'APC') = 'ARC' OR COALESCE(dt.isreversal, 'N') = 'Y' THEN CASE WHEN cil.line_gross_amount <> 0 THEN cil.line_gross_amount ELSE cil.linenetamt + cil.taxamt END * (-1) ELSE CASE WHEN col.line_gross_amount <> 0 THEN col.line_gross_amount ELSE col.linenetamt + ((SELECT sum(c_orderlinetax.taxamt) AS sum FROM c_orderlinetax WHERE c_orderlinetax.c_orderline_id = col.c_orderline_id)) END END AS totalamt_ord, cil.c_invoiceline_id, ci.c_invoice_id, ci.c_bpartner_id AS c_bpartner_inv_id, ci.c_currency_id AS c_currency_inv_id, CASE WHEN cil.line_gross_amount <> 0 THEN cil.line_gross_amount ELSE cil.linenetamt + cil.taxamt END * CASE WHEN COALESCE(dt.isreversal, 'N') = 'Y' OR COALESCE(dt.docbasetype, 'APC') = 'ARC' OR COALESCE(dt.isreversal, 'N') = 'Y' THEN - 1 ELSE 1 END AS totalamt_inv, ci.docstatus AS status_inv, co.docstatus AS status_ord, ci.dateinvoiced AS date_inv, co.dateordered AS date_ord FROM c_orderline col LEFT JOIN c_order co ON col.c_order_id = co.c_order_id FULL JOIN c_invoiceline cil ON col.c_orderline_id = cil.c_orderline_id LEFT JOIN c_invoice ci ON cil.c_invoice_id = ci.c_invoice_id LEFT JOIN c_doctype dt ON dt.c_doctype_id = ci.c_doctype_id WHERE (co.issotrx = 'N' OR ci.issotrx = 'N') AND (col.em_sfb_budget_cert_line_id IS NOT NULL OR cil.em_sfb_budget_cert_line_id IS NOT NULL) AND (col.em_sfb_isnotbudgetable = 'N' OR cil.em_sfb_isnotbudgetable = 'N')]]></view>
  </database>
