<?xml version="1.0"?>
  <database name="TRIGGER SFPR_ESURROGATE_DETAIL_TRG">
    <trigger name="SFPR_ESURROGATE_DETAIL_TRG" table="SFPR_EMPLOYEE_SURROGATE" fires="before" insert="false" update="true" delete="true" foreach="row">
      <body><![CDATA[
   V_MOVEMENT_ID VARCHAR(32); 	--OBTG:VARCHAR2--
   V_COUNT NUMBER;		--OBTG:NUMBER--

 
BEGIN
    
    
  IF AD_isTriggerEnabled()='N' THEN RETURN;
  END IF; 

  IF (DELETING) THEN

	V_MOVEMENT_ID:= :OLD.SFPR_EMPLOYEE_SURROGATE_ID;

	
	IF V_MOVEMENT_ID IS NOT NULL THEN

		SELECT COUNT(*)
		INTO V_COUNT
		FROM SFPR_SURROGATE_DETAIL
		WHERE SFPR_EMPLOYEE_SURROGATE_ID = V_MOVEMENT_ID;

		IF V_COUNT > 0 THEN
			RAISE_APPLICATION_ERROR(-20000, '@Sfpr_ValidateSurrogateDetail@');
		END IF;
		
	END IF;
	
  /*ELSIF (UPDATING) THEN

	V_MOVEMENT_ID:= :OLD.SFPR_EMPLOYEE_SURROGATE_ID;

	
	IF V_MOVEMENT_ID IS NOT NULL THEN

		SELECT COUNT(*)
		INTO V_COUNT
		FROM SSPR_CONCEPT_AMOUNT CA
		LEFT JOIN SFPR_SURROGATE_DETAIL SD ON SD.SFPR_SURROGATE_DETAIL_ID = CA.EM_SFPR_SURROGATE_DETAIL_ID 
		WHERE CA.EM_SFPR_SURROGATE_DETAIL_ID  = V_MOVEMENT_ID;


		IF V_COUNT > 0 THEN
			RAISE_APPLICATION_ERROR(-20000, '@Sfpr_ValidateSurrogateDetail@');
		END IF;
		
	END IF;	*/
	 	
  END IF;
  

  END SFPR_ESURROGATE_DETAIL_TRG
]]></body>
    </trigger>
  </database>
