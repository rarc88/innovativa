<?xml version="1.0"?>
  <database name="VIEW SSWH_INVOICE_RECEIPT">
    <view name="SSWH_INVOICE_RECEIPT"><![CDATA[SELECT a.value, a.name, a.doctype, a.description, sum(a.amt_doc_bp) AS saldo, sum(a.amt_doc_ppa) AS saldo1, sum(a.amt_doc_bp) + sum(a.amt_doc_ppa) AS saldo_total, a.obs FROM (((((((SELECT ad_message_get2('PTR_INVOICE', 'es_ES') AS tipo, 'I' AS doctype, i.documentno, bp.c_bpartner_id, bp.value, bp.name, i.dateinvoiced AS datetrx, max(dp.description) AS description, sum(CASE dp.isreceipt WHEN 'Y' THEN dp.amount ELSE - dp.amount END) AS amount, max(dp.dateplanned) AS dateplanned, i.c_invoice_id AS obs, sum(CASE dp.isreceipt WHEN 'Y' THEN dp.amount ELSE - dp.amount END) AS amt_doc_bp, 0 AS amt_doc_ppa, CASE i.issotrx WHEN 'N' THEN '../PurchaseInvoice/Header_Relation.html?Command=DIRECT' ELSE '../SalesInvoice/Header_Relation.html?Command=DIRECT' END AS url, 'inpcInvoiceId=' || i.c_invoice_id AS id, dp.isreceipt FROM c_debt_payment dp, c_invoice i, c_bpartner bp WHERE dp.c_invoice_id = i.c_invoice_id AND dp.c_bpartner_id = bp.c_bpartner_id AND 1 = 1 GROUP BY i.documentno, bp.c_bpartner_id, bp.value, bp.name, i.dateinvoiced, to_char(i.description), i.issotrx, i.c_invoice_id, dp.isreceipt UNION ALL SELECT ad_message_get2('PTR_MANUAL', 'es_ES') AS ad_message_get2, 'M' AS doctype, s.documentno, bp.c_bpartner_id, bp.value, bp.name, s.datetrx, dp.description, CASE dp.isreceipt WHEN 'Y' THEN dp.amount ELSE - dp.amount END AS amount, dp.dateplanned, s.description AS obs, CASE dp.isreceipt WHEN 'Y' THEN dp.amount ELSE - dp.amount END AS amt_doc_bp, 0 AS amt_doc_ppa, '../ManualSettlement/CreatePayment_Relation.html?Command=DIRECT' AS url, 'inpcDebtPaymentId=' || dp.c_debt_payment_id AS id, dp.isreceipt FROM c_debt_payment dp, c_settlement s, c_bpartner bp WHERE dp.c_settlement_generate_id = s.c_settlement_id AND dp.c_bpartner_id = bp.c_bpartner_id AND dp.ismanual = 'Y' AND dp.isvalid = 'Y' AND 2 = 2) UNION ALL SELECT ad_message_get2('PTR_CP_UNPAID', 'es_ES') AS ad_message_get2, 'C' AS doctype, s.documentno, bp.c_bpartner_id, bp.value, bp.name, s.datetrx, dp.description, CASE dp.isreceipt WHEN 'Y' THEN dp.amount ELSE - dp.amount END AS amount, dp.dateplanned, s.description AS obs, CASE dp.isreceipt WHEN 'Y' THEN - dp.amount ELSE dp.amount END AS amt_doc_bp, 0 AS amt_doc_ppa, '../Settlement/CancelledPayments_Relation.html?Command=DIRECT' AS url, 'inpcDebtPaymentId=' || dp.c_debt_payment_id AS id, dp.isreceipt FROM c_debt_payment dp, c_settlement s, c_bpartner bp WHERE dp.c_settlement_cancel_id = s.c_settlement_id AND dp.c_bpartner_id = bp.c_bpartner_id AND dp.cancel_processed = 'Y' AND dp.ispaid = 'N' AND 3 = 3) UNION ALL SELECT ad_message_get2('PTR_CP_PAID', 'es_ES') AS ad_message_get2, 'A' AS doctype, s.documentno, bp.c_bpartner_id, bp.value, bp.name, s.datetrx, dp.description, CASE dp.isreceipt WHEN 'Y' THEN dp.amount ELSE - dp.amount END AS amount, dp.dateplanned, s.description AS obs, CASE dp.isreceipt WHEN 'Y' THEN - dp.amount ELSE dp.amount END AS amt_doc_bp, CASE dp.isreceipt WHEN 'Y' THEN dp.amount ELSE - dp.amount END AS amt_doc_ppa, '../Settlement/CancelledPayments_Relation.html?Command=DIRECT' AS url, 'inpcDebtPaymentId=' || dp.c_debt_payment_id AS id, dp.isreceipt FROM c_debt_payment dp, c_settlement s, c_bpartner bp WHERE dp.c_settlement_cancel_id = s.c_settlement_id AND dp.c_bpartner_id = bp.c_bpartner_id AND dp.cancel_processed = 'Y' AND dp.ispaid = 'Y' AND 4 = 4) UNION ALL SELECT ad_message_get2('PTR_GP_UNPAID', 'es_ES') AS ad_message_get2, 'G' AS doctype, s.documentno, bp.c_bpartner_id, bp.value, bp.name, s.datetrx, dp.description, CASE dp.isreceipt WHEN 'Y' THEN dp.amount ELSE - dp.amount END AS amount, dp.dateplanned, s.description AS obs, CASE dp.isreceipt WHEN 'Y' THEN dp.amount ELSE - dp.amount END AS amt_doc_bp, 0 AS amt_doc_ppa, '../Settlement/CreatedPayments_Relation.html?Command=DIRECT' AS url, 'inpcDebtPaymentId=' || dp.c_debt_payment_id AS id, dp.isreceipt FROM c_debt_payment dp, c_settlement s, c_bpartner bp WHERE dp.c_settlement_generate_id = s.c_settlement_id AND dp.c_bpartner_id = bp.c_bpartner_id AND dp.generate_processed = 'Y' AND dp.ismanual = 'N' AND (dp.ispaid = 'N' OR dp.c_settlement_cancel_id IS NOT NULL) AND 5 = 5) UNION ALL SELECT ad_message_get2('PTR_GP_PAID', 'es_ES') AS ad_message_get2, 'J' AS doctype, s.documentno, bp.c_bpartner_id, bp.value, bp.name, s.datetrx, dp.description, CASE dp.isreceipt WHEN 'Y' THEN dp.amount ELSE - dp.amount END AS amount, dp.dateplanned, s.description AS obs, 0 AS amt_doc_bp, CASE dp.isreceipt WHEN 'Y' THEN dp.amount ELSE - dp.amount END AS amt_doc_ppa, '../Settlement/CreatedPayments_Relation.html?Command=DIRECT' AS url, 'inpcDebtPaymentId=' || dp.c_debt_payment_id AS id, dp.isreceipt FROM c_debt_payment dp, c_settlement s, c_bpartner bp WHERE dp.c_settlement_generate_id = s.c_settlement_id AND dp.c_bpartner_id = bp.c_bpartner_id AND dp.generate_processed = 'Y' AND dp.ispaid = 'Y' AND dp.c_settlement_cancel_id IS NULL AND 6 = 6) UNION ALL SELECT ad_message_get2('PTR_RP_CASH', 'es_ES') AS ad_message_get2, 'K' AS doctype, c.name AS documentno, bp.c_bpartner_id, bp.value, bp.name, c.dateacct AS datetrx, dp.description, CASE dp.isreceipt WHEN 'Y' THEN dp.amount ELSE - dp.amount END AS amount, dp.dateplanned, to_char(c.description) AS obs, 0 AS amt_doc_bp, CASE dp.isreceipt WHEN 'Y' THEN - dp.amount ELSE dp.amount END AS amt_doc_ppa, '../CashJournal/Lines_Relation.html?Command=DIRECT' AS url, 'inpcCashlineId=' || cl.c_cashline_id AS id, dp.isreceipt FROM c_debt_payment dp, c_cash c, c_cashline cl, c_bpartner bp WHERE dp.c_cashline_id = cl.c_cashline_id AND cl.c_cash_id = c.c_cash_id AND dp.c_bpartner_id = bp.c_bpartner_id AND c.processed = 'Y' AND 7 = 7) UNION ALL SELECT ad_message_get2('PTR_RP_BANK', 'es_ES') AS ad_message_get2, 'B' AS doctype, b.name AS documentno, bp.c_bpartner_id, bp.value, bp.name, bl.dateacct AS datetrx, dp.description, CASE dp.isreceipt WHEN 'Y' THEN dp.amount ELSE - dp.amount END AS amount, dp.dateplanned, to_char(b.description) AS obs, 0 AS amt_doc_bp, CASE dp.isreceipt WHEN 'Y' THEN - dp.amount ELSE dp.amount END AS amt_doc_ppa, '../BankStatement/Lines_Relation.html?Command=DIRECT' AS url, 'inpcBankstatementlineId=' || bl.c_bankstatementline_id AS id, dp.isreceipt FROM c_debt_payment dp, c_bankstatement b, c_bankstatementline bl, c_bpartner bp WHERE dp.c_bankstatementline_id = bl.c_bankstatementline_id AND bl.c_bankstatement_id = b.c_bankstatement_id AND dp.c_bpartner_id = bp.c_bpartner_id AND b.processed = 'Y' AND 8 = 8) a LEFT JOIN (SELECT aaa.c_bpartner_id, sum(aaa.amount) AS initialamount FROM ((((SELECT i.c_bpartner_id, CASE dp.isreceipt WHEN 'Y' THEN dp.amount ELSE - dp.amount END AS amount FROM c_debt_payment dp, c_invoice i WHERE dp.c_invoice_id = i.c_invoice_id AND i.dateacct <= now() UNION ALL SELECT dp.c_bpartner_id, CASE dp.isreceipt WHEN 'Y' THEN dp.amount ELSE - dp.amount END AS amount FROM c_debt_payment dp, c_settlement s WHERE dp.c_settlement_generate_id = s.c_settlement_id AND dp.ismanual = 'Y' AND dp.isvalid = 'Y' AND s.dateacct <= now()) UNION ALL SELECT dp.c_bpartner_id, CASE dp.isreceipt WHEN 'Y' THEN dp.amount ELSE - dp.amount END AS amount FROM c_debt_payment dp, c_settlement s WHERE dp.c_settlement_generate_id = s.c_settlement_id AND dp.generate_processed = 'Y' AND dp.ismanual = 'N' AND (dp.ispaid = 'N' OR dp.c_settlement_cancel_id IS NOT NULL) AND s.dateacct <= now()) UNION ALL SELECT dp.c_bpartner_id, - CASE dp.isreceipt WHEN 'Y' THEN dp.amount ELSE - dp.amount END AS amount FROM c_debt_payment dp, c_settlement s WHERE dp.c_settlement_cancel_id = s.c_settlement_id AND dp.cancel_processed = 'Y' AND dp.ispaid = 'N' AND s.dateacct <= now()) UNION ALL SELECT dp.c_bpartner_id, - CASE dp.isreceipt WHEN 'Y' THEN dp.amount ELSE - dp.amount END AS amount FROM c_debt_payment dp, c_settlement s WHERE dp.c_settlement_cancel_id = s.c_settlement_id AND dp.cancel_processed = 'Y' AND dp.ispaid = 'Y' AND s.dateacct <= now()) aaa GROUP BY aaa.c_bpartner_id) b ON a.c_bpartner_id = b.c_bpartner_id LEFT JOIN (SELECT bbb.c_bpartner_id, sum(bbb.amount) AS initialamount FROM (((SELECT dp.c_bpartner_id, CASE dp.isreceipt WHEN 'Y' THEN dp.amount ELSE - dp.amount END AS amount FROM c_debt_payment dp, c_settlement s WHERE dp.c_settlement_cancel_id = s.c_settlement_id AND dp.cancel_processed = 'Y' AND dp.ispaid = 'Y' AND s.dateacct <= now() UNION ALL SELECT dp.c_bpartner_id, CASE dp.isreceipt WHEN 'Y' THEN dp.amount ELSE - dp.amount END AS amount FROM c_debt_payment dp, c_settlement s WHERE dp.c_settlement_generate_id = s.c_settlement_id AND dp.generate_processed = 'Y' AND dp.ispaid = 'Y' AND dp.c_settlement_cancel_id IS NULL AND s.dateacct <= now()) UNION ALL SELECT dp.c_bpartner_id, - CASE dp.isreceipt WHEN 'Y' THEN dp.amount ELSE - dp.amount END AS amount FROM c_debt_payment dp, c_cash c, c_cashline cl WHERE dp.c_cashline_id = cl.c_cashline_id AND cl.c_cash_id = c.c_cash_id AND c.processed = 'Y' AND c.dateacct <= now()) UNION ALL SELECT dp.c_bpartner_id, - CASE dp.isreceipt WHEN 'Y' THEN dp.amount ELSE - dp.amount END AS amount FROM c_debt_payment dp, c_bankstatement b, c_bankstatementline bl WHERE dp.c_bankstatementline_id = bl.c_bankstatementline_id AND bl.c_bankstatement_id = b.c_bankstatement_id AND b.processed = 'Y' AND bl.dateacct <= now()) bbb GROUP BY bbb.c_bpartner_id) c ON a.c_bpartner_id = c.c_bpartner_id WHERE a.isreceipt = 'Y' AND a.datetrx <= now() GROUP BY a.value, a.name, a.doctype, a.description, a.obs ORDER BY a.name, a.description, a.doctype DESC]]></view>
  </database>
