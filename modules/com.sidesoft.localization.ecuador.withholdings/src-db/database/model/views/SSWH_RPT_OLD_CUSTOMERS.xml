<?xml version="1.0"?>
  <database name="VIEW SSWH_RPT_OLD_CUSTOMERS">
    <view name="SSWH_RPT_OLD_CUSTOMERS"><![CDATA[SELECT a.c_invoice_id, a.created, a.documentno, to_date(a.dateinvoiced) AS dateinvoiced, a.dateinvoiced + ((SELECT c_paymentterm.netdays FROM c_paymentterm WHERE c_paymentterm.c_paymentterm_id = a.c_paymentterm_id)) AS duedate, (SELECT c_bpartner.name FROM c_bpartner WHERE c_bpartner.c_bpartner_id = a.c_bpartner_id) AS partner, (SELECT c_doctype.name FROM c_doctype WHERE c_doctype.c_doctype_id = a.c_doctype_id) AS document_type, a.poreference, (SELECT c_paymentterm.name FROM c_paymentterm WHERE c_paymentterm.c_paymentterm_id = a.c_paymentterm_id) AS paymenterm, a.grandtotal, a.description FROM c_invoice a WHERE a.docstatus = 'CO' AND a.issotrx = 'Y' UNION ALL SELECT a.c_invoice_id, c.created, a.documentno, to_date(a.dateinvoiced) AS dateinvoiced, a.dateinvoiced + ((SELECT c_paymentterm.netdays FROM c_paymentterm WHERE c_paymentterm.c_paymentterm_id = a.c_paymentterm_id)) AS duedate, (SELECT c_bpartner.name FROM c_bpartner WHERE c_bpartner.c_bpartner_id = a.c_bpartner_id) AS partner, 'Cobro' AS document_type, (d.documentno || ' ') || d.name AS poreference, (SELECT c_paymentterm.name FROM c_paymentterm WHERE c_paymentterm.c_paymentterm_id = a.c_paymentterm_id) AS paymenterm, c.stmtamt * (-1) AS grandtotal, a.description FROM c_invoice a JOIN c_debt_payment b ON a.c_invoice_id = b.c_invoice_id JOIN c_bankstatementline c ON b.c_bankstatementline_id = c.c_bankstatementline_id JOIN c_bankstatement d ON c.c_bankstatement_id = d.c_bankstatement_id WHERE a.docstatus = 'CO' AND a.issotrx = 'Y']]></view>
  </database>
