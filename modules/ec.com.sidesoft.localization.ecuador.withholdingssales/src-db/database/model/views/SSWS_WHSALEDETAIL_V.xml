<?xml version="1.0"?>
  <database name="VIEW SSWS_WHSALEDETAIL_V">
    <view name="SSWS_WHSALEDETAIL_V"><![CDATA[SELECT ws.ad_client_id, ws.ad_org_id, ws.isactive, ws.ssws_withholdingsale_id AS ssws_whsaledetail_v_id, ws.created, ws.createdby, ws.updated, ws.updatedby, ws.withholdingdate, ws.ssws_withholdingsale_id, CASE COALESCE(psd.em_ssws_amount, 0.0) WHEN 0.0 THEN ws.totalwhrentalamt + ws.totalwhivaamt ELSE COALESCE(psd.em_ssws_amount, 0.0) END AS amount, ps.fin_payment_schedule_id FROM ssws_withholdingsale ws JOIN c_invoice i ON ws.c_invoice_id = i.c_invoice_id JOIN fin_payment_schedule ps ON ps.c_invoice_id = i.c_invoice_id LEFT JOIN fin_payment_scheduledetail psd ON psd.fin_payment_detail_id IS NULL AND psd.fin_payment_schedule_invoice = ps.fin_payment_schedule_id AND psd.em_ssws_withholdingsale_id = ws.ssws_withholdingsale_id WHERE ws.processed = 'Y' AND (ws.paidinvoice = 'Y' AND psd.fin_payment_scheduledetail_id IS NULL OR ws.paidinvoice = 'N')]]></view>
  </database>
