<?xml version="1.0"?>
  <database name="TRIGGER SSWH_CHECKBOOKPOSLINE_TR1">
    <trigger name="SSWH_CHECKBOOKPOSLINE_TR1" table="SSWH_CHECKBOOKPOSLINE" fires="after" insert="true" update="true" delete="true" foreach="row">
      <body><![CDATA[
V_NMONTO NUMBER;
V_OMONTO NUMBER;
Begin

IF (UPDATING OR INSERTING) THEN
   IF UPDATING THEN
   V_NMONTO:=COALESCE(:NEW.GRANTTOTAL,0);
   V_OMONTO:=COALESCE(:OLD.GRANTTOTAL,0);
   UPDATE sswh_CHECKBOOKPOS
   SET GRANTTOTAL= GRANTTOTAL + V_NMONTO - V_OMONTO
   WHERE sswh_CHECKBOOKPOS_ID=:NEW.sswh_CHECKBOOKPOS_ID;

   ELSE
   V_NMONTO:=COALESCE(:NEW.GRANTTOTAL,0);
   UPDATE sswh_CHECKBOOKPOS
   SET GRANTTOTAL= GRANTTOTAL + V_NMONTO
   WHERE sswh_CHECKBOOKPOS_ID=:NEW.sswh_CHECKBOOKPOS_ID;
   
   END IF;
   
ELSE
   V_OMONTO:=COALESCE(:OLD.GRANTTOTAL,0);
   UPDATE sswh_CHECKBOOKPOS
   SET GRANTTOTAL= GRANTTOTAL - V_OMONTO
   WHERE sswh_CHECKBOOKPOS_ID=:OLD.sswh_CHECKBOOKPOS_ID;

END IF;
END SSWH_CHECKBOOKPOSLINE_TR1
]]></body>
    </trigger>
  </database>
