<?xml version="1.0"?>
  <database name="VIEW SSWH_RESUMEN_VENTA_CATEGORIA">
    <view name="SSWH_RESUMEN_VENTA_CATEGORIA"><![CDATA[SELECT fac.dateinvoiced AS fecha, prcg.name AS categoria, prod.value AS id_producto, prod.name AS producto, CASE tdoc.name WHEN 'Factura de Venta GYE' THEN line.linenetamt ELSE 0 END AS monto_factura, CASE tdoc.name WHEN 'Nota de Credito Ventas' THEN line.linenetamt ELSE 0 END AS monto_devolucion, x.value AS org, y.value AS entidad FROM c_invoice fac LEFT JOIN c_invoiceline line ON fac.c_invoice_id = line.c_invoice_id LEFT JOIN c_doctype tdoc ON fac.c_doctype_id = tdoc.c_doctype_id LEFT JOIN m_product prod ON line.m_product_id = prod.m_product_id LEFT JOIN m_product_category prcg ON prod.m_product_category_id = prcg.m_product_category_id LEFT JOIN ad_org x ON fac.ad_org_id = x.ad_org_id LEFT JOIN ad_client y ON fac.ad_client_id = y.ad_client_id UNION ALL SELECT fac.dateinvoiced AS fecha, prcg.name AS categoria, prod.value AS id_producto, prod.name AS producto, CASE tdoc.name WHEN 'Factura de venta UIO' THEN line.linenetamt ELSE 0 END AS monto_factura, CASE tdoc.name WHEN 'Nota de Credito Ventas' THEN 0 ELSE 0 END AS monto_devolucion, x.value AS org, y.value AS entidad FROM c_invoice fac LEFT JOIN c_invoiceline line ON fac.c_invoice_id = line.c_invoice_id LEFT JOIN c_doctype tdoc ON fac.c_doctype_id = tdoc.c_doctype_id LEFT JOIN m_product prod ON line.m_product_id = prod.m_product_id LEFT JOIN m_product_category prcg ON prod.m_product_category_id = prcg.m_product_category_id LEFT JOIN ad_org x ON fac.ad_org_id = x.ad_org_id LEFT JOIN ad_client y ON fac.ad_client_id = y.ad_client_id WHERE fac.docstatus = 'CO' AND (tdoc.name IN ('Factura de Venta GYE', 'Factura de venta UIO', 'Nota de Credito Ventas'))]]></view>
  </database>
