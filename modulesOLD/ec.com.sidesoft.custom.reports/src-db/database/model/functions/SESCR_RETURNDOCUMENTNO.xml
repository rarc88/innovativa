<?xml version="1.0"?>
  <database name="FUNCTION SESCR_RETURNDOCUMENTNO">
    <function name="SESCR_RETURNDOCUMENTNO" type="VARCHAR">
      <parameter name="v_numdoc" type="VARCHAR" mode="in">
        <default/>
      </parameter>
      <body><![CDATA[V_ACUMSIG         NUMBER(5):=0;         --OBTG:NUMBER--
V_POSF            NUMBER(5):=0;         --OBTG:NUMBER--
V_CONTARSIG       NUMBER(5):=0;         --OBTG:NUMBER--

V_DOCUMENTPART1   VARCHAR2(40):= '';    --OBTG:VARCHAR2--
V_DOCUMENTPART2   VARCHAR2(40):= '';    --OBTG:VARCHAR2--
V_DOCRETURN       VARCHAR2(40):= '';    --OBTG:VARCHAR2--
V_DOCUMENTO       VARCHAR2(40):= '';    --OBTG:VARCHAR2--
V_BSQCARACT       VARCHAR2(40):= '';    --OBTG:VARCHAR2--

BEGIN

V_DOCUMENTO:= V_NUMDOC;
DBMS_OUTPUT.PUT_LINE('NUMERO DE DOCUMENTO = ' || V_DOCUMENTO) ;
V_CONTARSIG:= LENGTH(V_DOCUMENTO);

IF (V_CONTARSIG > 0 ) THEN

  FOR i IN 1..V_CONTARSIG  loop
    
    V_BSQCARACT:= SUBSTR(TRIM(V_DOCUMENTO),i,1); -- 001-001-90
    
    IF (V_BSQCARACT = '-') THEN
      V_ACUMSIG:=V_ACUMSIG + 1;
      V_POSF:= i+1;
    END IF;
    
  END LOOP;
  
  IF (V_ACUMSIG = 1) THEN
    
    V_DOCUMENTPART2:=SUBSTR(TRIM(V_DOCUMENTO),V_POSF, (V_CONTARSIG - V_ACUMSIG));
    V_DOCUMENTPART1:=SUBSTR(TRIM(V_DOCUMENTO),1, V_POSF-1);
    V_DOCRETURN:=V_DOCUMENTPART1 ||  (LPAD(V_DOCUMENTPART2,9,'0'));
    RETURN V_DOCRETURN;
    
  END IF;
  IF (V_ACUMSIG = 2) THEN
    
    V_DOCUMENTPART2:=SUBSTR(TRIM(V_DOCUMENTO),V_POSF, (V_CONTARSIG - V_ACUMSIG));
    V_DOCUMENTPART1:=SUBSTR(TRIM(V_DOCUMENTO),1, V_POSF-1);
    V_DOCRETURN:=V_DOCUMENTPART1 ||  (LPAD(V_DOCUMENTPART2,9,'0'));
    RETURN V_DOCRETURN;
    
  END IF;

END IF;

IF V_ACUMSIG = 0 THEN
  
  RETURN (LPAD(V_DOCUMENTO,9,'0'));
  
END IF;
END SESCR_RETURNDOCUMENTNO
]]></body>
    </function>
  </database>
