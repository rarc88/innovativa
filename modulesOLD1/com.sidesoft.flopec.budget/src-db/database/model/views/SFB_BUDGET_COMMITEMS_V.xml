<?xml version="1.0"?>
  <database name="VIEW SFB_BUDGET_COMMITEMS_V">
    <view name="SFB_BUDGET_COMMITEMS_V"><![CDATA[SELECT bcl.budget_committed_value AS totalamt, bl.sfb_budget_line_id AS budgetline_id FROM sfb_budget_line bl LEFT JOIN sfb_budget_version bv ON bl.sfb_budget_version_id = bv.sfb_budget_version_id LEFT JOIN sfb_budget b ON bv.sfb_budget_id = b.sfb_budget_id, sfb_budget_cert_line bcl LEFT JOIN sfb_budget_certificate bc ON bcl.sfb_budget_certificate_id = bc.sfb_budget_certificate_id LEFT JOIN fin_payment_detail sfbp ON bcl.sfb_budget_cert_line_id = sfbp.em_sfb_budget_cert_line_id WHERE bcl.ad_client_id = bl.ad_client_id AND bcl.ad_org_id = bl.ad_org_id AND bcl.c_costcenter_id = bl.c_costcenter_id AND bcl.user1_id = bl.user1_id AND bcl.sfb_budget_item_id = bl.sfb_budget_item_id AND bc.sfb_budget_area_id = bl.sfb_budget_area_id AND bv.version_status = 'AP' AND bc.type_of_budget = b.type_of_budget AND bc.c_year_id = b.c_year_id UNION ALL SELECT bcl.committed_value AS totalamt, bl.sfb_budget_line_id AS budgetline_id FROM sfb_budget_line bl LEFT JOIN sfb_budget_version bv ON bl.sfb_budget_version_id = bv.sfb_budget_version_id LEFT JOIN sfb_budget b ON bv.sfb_budget_id = b.sfb_budget_id, sfb_budget_cert_line bcl LEFT JOIN sfb_budget_certificate bc ON bcl.sfb_budget_certificate_id = bc.sfb_budget_certificate_id WHERE bcl.ad_client_id = bl.ad_client_id AND bcl.ad_org_id = bl.ad_org_id AND bcl.c_costcenter_id = bl.c_costcenter_id AND bcl.user1_id = bl.user1_id AND bcl.sfb_budget_item_id = bl.sfb_budget_item_id AND bc.sfb_budget_area_id = bl.sfb_budget_area_id AND bv.version_status = 'AP' AND bc.type_of_budget = b.type_of_budget AND bc.c_year_id = b.c_year_id AND bc.type_of_certificate = 'SSBP_P' AND bc.processed = 'Y' UNION ALL SELECT va.totalamt_viatical AS totalamt, bl.sfb_budget_line_id AS budgetline_id FROM ssve_viatical_details_aux2 va LEFT JOIN ssve_viatical_details_aux4 vs ON vs.ssve_viatical_id = va.ssve_viatical_id AND vs.sfb_budget_cert_line_id = va.sfb_budget_cert_line_id LEFT JOIN ssve_viatical v ON v.ssve_viatical_id = va.ssve_viatical_id, sfb_budget_line bl LEFT JOIN sfb_budget_version bv ON bl.sfb_budget_version_id = bv.sfb_budget_version_id LEFT JOIN sfb_budget b ON bv.sfb_budget_id = b.sfb_budget_id, sfb_budget_cert_line bcl LEFT JOIN sfb_budget_certificate bc ON bcl.sfb_budget_certificate_id = bc.sfb_budget_certificate_id WHERE bcl.ad_client_id = bl.ad_client_id AND bcl.ad_org_id = bl.ad_org_id AND bcl.c_costcenter_id = bl.c_costcenter_id AND bcl.user1_id = bl.user1_id AND bcl.sfb_budget_item_id = bl.sfb_budget_item_id AND bc.sfb_budget_area_id = bl.sfb_budget_area_id AND bv.version_status = 'AP' AND bc.type_of_budget = b.type_of_budget AND bc.c_year_id = b.c_year_id AND va.sfb_budget_cert_line_id = bcl.sfb_budget_cert_line_id UNION ALL SELECT CASE WHEN gl.amtsourcedr = 0 THEN gl.amtsourcecr * CASE WHEN gl.em_sfb_affectbudget = 'Y' THEN (-1) ELSE 1 END ELSE gl.amtsourcedr * CASE WHEN gl.em_sfbin_affectincomebudget = 'Y' THEN (-1) ELSE 1 END END AS totalamt, bl.sfb_budget_line_id AS budgetline_id FROM gl_journalline gl LEFT JOIN gl_journal g ON gl.gl_journal_id = g.gl_journal_id, sfb_budget_cert_line bcl LEFT JOIN sfb_budget_certificate bc ON bcl.sfb_budget_certificate_id = bc.sfb_budget_certificate_id, sfb_budget_line bl LEFT JOIN sfb_budget_version bv ON bl.sfb_budget_version_id = bv.sfb_budget_version_id LEFT JOIN sfb_budget b ON bv.sfb_budget_id = b.sfb_budget_id WHERE bcl.ad_client_id = bl.ad_client_id AND bcl.ad_org_id = bl.ad_org_id AND bcl.c_costcenter_id = bl.c_costcenter_id AND bcl.user1_id = bl.user1_id AND bcl.sfb_budget_item_id = bl.sfb_budget_item_id AND bc.sfb_budget_area_id = bl.sfb_budget_area_id AND bv.version_status = 'AP' AND bc.type_of_budget = b.type_of_budget AND bc.c_year_id = b.c_year_id AND gl.em_sfb_budget_cert_line_id = bcl.sfb_budget_cert_line_id AND gl.em_sfb_budget_cert_line_id IS NOT NULL AND g.docstatus = 'CO' UNION ALL SELECT bd.totalamt, bl.sfb_budget_line_id AS budgetline_id FROM scbd_budget_direct bd, sfb_budget_cert_line bcl LEFT JOIN sfb_budget_certificate bc ON bcl.sfb_budget_certificate_id = bc.sfb_budget_certificate_id, sfb_budget_line bl LEFT JOIN sfb_budget_version bv ON bl.sfb_budget_version_id = bv.sfb_budget_version_id LEFT JOIN sfb_budget b ON bv.sfb_budget_id = b.sfb_budget_id WHERE bcl.ad_client_id = bl.ad_client_id AND bcl.ad_org_id = bl.ad_org_id AND bcl.c_costcenter_id = bl.c_costcenter_id AND bcl.user1_id = bl.user1_id AND bcl.sfb_budget_item_id = bl.sfb_budget_item_id AND bc.sfb_budget_area_id = bl.sfb_budget_area_id AND bv.version_status = 'AP' AND bc.type_of_budget = b.type_of_budget AND bc.c_year_id = b.c_year_id AND bd.sfb_budget_cert_line_id = bcl.sfb_budget_cert_line_id]]></view>
  </database>
