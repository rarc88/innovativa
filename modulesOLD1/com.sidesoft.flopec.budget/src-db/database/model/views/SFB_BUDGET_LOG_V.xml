<?xml version="1.0"?>
  <database name="VIEW SFB_BUDGET_LOG_V">
    <view name="SFB_BUDGET_LOG_V"><![CDATA[SELECT get_uuid() AS sfb_budget_log_v_id, sbl.ad_org_id, sbl.ad_client_id, sbl.created, sbl.createdby, sbl.updatedby, sbl.updated, sbl.isactive, sbl.sfb_budget_area_id AS area_id, sfba.name AS area, sbl.c_costcenter_id AS buque_id, cc.name AS buque, sbl.user1_id AS linea_negocio_id, u1.name AS linea_negocio, sbl.budget_item_from_id AS item_from_id, sfbi.name AS item_from, sbl.budget_item_to_id AS item_to_id, sfbi2.name AS item_to, sfbl.sfb_budget_line_id AS presupuesto_id, sfbl.line AS linea_presupuesto, sbl.sfb_budget_log_id, sbl.type, sbl.resolutionno, sbl.month_from, sbl.month_to, sbl.process AS budget_log_status, sbl.value AS codigo, COALESCE(sbl.description, '') AS description, sbl.type_operation, sbl.reg_date FROM sfb_budget_log sbl LEFT JOIN sfb_budget_log_line sbll ON sbll.sfb_budget_log_id = sbl.sfb_budget_log_id JOIN sfb_budget sfb ON sfb.type_of_budget = sbl.type_of_budget AND sfb.c_year_id = sbl.c_year_id JOIN sfb_budget_version sfbv ON sfbv.sfb_budget_id = sfb.sfb_budget_id AND sfbv.version_status = 'AP' JOIN sfb_budget_line sfbl ON sbl.sfb_budget_area_id = sfbl.sfb_budget_area_id AND sbl.c_costcenter_id = sfbl.c_costcenter_id AND sbl.user1_id = sfbl.user1_id AND sbl.budget_item_to_id = sfbl.sfb_budget_item_id AND sfbv.sfb_budget_version_id = sfbl.sfb_budget_version_id JOIN sfb_budget_area sfba ON sfba.sfb_budget_area_id = sbl.sfb_budget_area_id JOIN c_costcenter cc ON cc.c_costcenter_id = sbl.c_costcenter_id JOIN user1 u1 ON u1.user1_id = sbl.user1_id LEFT JOIN sfb_budget_item sfbi ON sfbi.sfb_budget_item_id = sbl.budget_item_from_id JOIN sfb_budget_item sfbi2 ON sfbi2.sfb_budget_item_id = sbl.budget_item_to_id WHERE sbl.process = 'Y' AND sbll.sfb_budget_log_line_id IS NULL UNION ALL SELECT get_uuid() AS sfb_budget_log_v_id, sbl.ad_org_id, sbl.ad_client_id, sbl.created, sbl.createdby, sbl.updatedby, sbl.updated, sbl.isactive, sbl.sfb_budget_area_id AS area_id, sfba.name AS area, sbl.c_costcenter_id AS buque_id, cc.name AS buque, sbl.user1_id AS linea_negocio_id, u1.name AS linea_negocio, sbl.budget_item_from_id AS item_from_id, sfbi.name AS item_from, sbl.budget_item_to_id AS item_to_id, sfbi2.name AS item_to, sfbl.sfb_budget_line_id AS presupuesto_id, sfbl.line AS linea_presupuesto, sbl.sfb_budget_log_id, sbl.type, sbl.resolutionno, sbl.month_from, sbl.month_to, sbl.process AS budget_log_status, sbll.jan_newadjusted_value - sbll.jan_adjusted_value + sbll.feb_newadjusted_value - sbll.feb_adjusted_value + sbll.mar_newadjusted_value - sbll.mar_adjusted_value + sbll.apr_newadjusted_value - sbll.apr_adjusted_value + sbll.may_newadjusted_value - sbll.may_adjusted_value + sbll.jun_newadjusted_value - sbll.jun_adjusted_value + sbll.jul_newadjusted_value - sbll.jul_adjusted_value + sbll.aug_newadjusted_value - sbll.aug_adjusted_value + sbll.sep_newadjusted_value - sbll.sep_adjusted_value + sbll.oct_newadjusted_value - sbll.oct_adjusted_value + sbll.nov_newadjusted_value - sbll.nov_adjusted_value + sbll.dec_newadjusted_value - sbll.dec_adjusted_value AS codigo, COALESCE(sbl.description, '') AS description, sbl.type_operation, sbl.reg_date FROM sfb_budget_log sbl JOIN sfb_budget_log_line sbll ON sbll.sfb_budget_log_id = sbl.sfb_budget_log_id JOIN sfb_budget_line sfbl ON sbll.sfb_budget_line_id = sfbl.sfb_budget_line_id JOIN sfb_budget_version sfbv ON sfbv.sfb_budget_version_id = sfbl.sfb_budget_version_id JOIN sfb_budget sfb ON sfbv.sfb_budget_id = sfb.sfb_budget_id JOIN sfb_budget_area sfba ON sfba.sfb_budget_area_id = sfbl.sfb_budget_area_id JOIN c_costcenter cc ON cc.c_costcenter_id = sfbl.c_costcenter_id JOIN user1 u1 ON u1.user1_id = sfbl.user1_id LEFT JOIN sfb_budget_item sfbi ON sfbi.sfb_budget_item_id = sfbl.sfb_budget_item_id AND sbll.direction = 'F' JOIN sfb_budget_item sfbi2 ON sfbi2.sfb_budget_item_id = sfbl.sfb_budget_item_id AND sbll.direction = 'T' WHERE sbl.process = 'Y' UNION ALL SELECT get_uuid() AS sfb_budget_log_v_id, sbl.ad_org_id, sbl.ad_client_id, sbl.created, sbl.createdby, sbl.updatedby, sbl.updated, sbl.isactive, sbl.sfb_budget_area_id AS area_id, sfba.name AS area, sbl.c_costcenter_id AS buque_id, cc.name AS buque, sbl.user1_id AS linea_negocio_id, u1.name AS linea_negocio, sbl.budget_item_from_id AS item_from_id, sfbi.name AS item_from, sbl.budget_item_to_id AS item_to_id, sfbi2.name AS item_to, sfbl.sfb_budget_line_id AS presupuesto_id, sfbl.line AS linea_presupuesto, sbl.sfb_budget_log_id, sbl.type, sbl.resolutionno, sbl.month_from, sbl.month_to, sbl.process AS budget_log_status, sbll.jan_newadjusted_value - sbll.jan_adjusted_value + sbll.feb_newadjusted_value - sbll.feb_adjusted_value + sbll.mar_newadjusted_value - sbll.mar_adjusted_value + sbll.apr_newadjusted_value - sbll.apr_adjusted_value + sbll.may_newadjusted_value - sbll.may_adjusted_value + sbll.jun_newadjusted_value - sbll.jun_adjusted_value + sbll.jul_newadjusted_value - sbll.jul_adjusted_value + sbll.aug_newadjusted_value - sbll.aug_adjusted_value + sbll.sep_newadjusted_value - sbll.sep_adjusted_value + sbll.oct_newadjusted_value - sbll.oct_adjusted_value + sbll.nov_newadjusted_value - sbll.nov_adjusted_value + sbll.dec_newadjusted_value - sbll.dec_adjusted_value AS codigo, COALESCE(sbl.description, '') AS description, sbl.type_operation, sbl.reg_date FROM sfb_budget_log sbl JOIN sfb_budget_log_line sbll ON sbll.sfb_budget_log_id = sbl.sfb_budget_log_id JOIN sfb_budget_line sfbl ON sbll.sfb_budget_line_id = sfbl.sfb_budget_line_id JOIN sfb_budget_version sfbv ON sfbv.sfb_budget_version_id = sfbl.sfb_budget_version_id JOIN sfb_budget sfb ON sfbv.sfb_budget_id = sfb.sfb_budget_id JOIN sfb_budget_area sfba ON sfba.sfb_budget_area_id = sfbl.sfb_budget_area_id JOIN c_costcenter cc ON cc.c_costcenter_id = sfbl.c_costcenter_id JOIN user1 u1 ON u1.user1_id = sfbl.user1_id LEFT JOIN sfb_budget_item sfbi ON sfbi.sfb_budget_item_id = sfbl.sfb_budget_item_id AND sbll.direction = 'T' JOIN sfb_budget_item sfbi2 ON sfbi2.sfb_budget_item_id = sfbl.sfb_budget_item_id AND sbll.direction = 'F' WHERE sbl.process = 'Y']]></view>
  </database>
