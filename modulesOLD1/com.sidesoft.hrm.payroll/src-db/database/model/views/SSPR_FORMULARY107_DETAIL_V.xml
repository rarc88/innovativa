<?xml version="1.0"?>
  <database name="VIEW SSPR_FORMULARY107_DETAIL_V">
    <view name="SSPR_FORMULARY107_DETAIL_V"><![CDATA[SELECT y.sspr_formulary107_detail_v_id, y.ad_client_id, y.ad_org_id, y.created, y.createdby, y.updated, y.updatedby, y.isactive, y.anio_entrega, y.mes_entrega, y.dia_entrega, y.taxid_org, y.org, y.year, y.c_year_id, y.c_bpartner_id, y.taxid_employee, y.empleado, y.tipoidentificacion, y.numeroidentificacion, y.empleadoapellido, y.empleadonombre, y.codigoestab, y.pais, y.codigopais, y.aplicaconvenio, y.discapacitado, y.porcentajediscapacidad, y.tipoidentdiscapacidad, y.numeroidentifdiscapacidad, y.sueldo, y.bonos, y.utilidades, y.impuestorenta, y.decimotercero, y.decimocuarto, y.fondosreserva, y.compensacionsalariodigno, y.otrosing_rentagravada, round(y.sueldo + y.bonos + y.utilidades, 2) AS ingresosgrav349, y.sistemasalariodigno, y.aportepersonal, y.impuestorentacausado, y.valorimprettrabajador, y.gastosvivienda, y.gastossalud, y.gastoseducacion, y.gastoalimentacion, y.gastosvestimenta, y.ingresosgravados, y.aportepersonalo, y.exoneracionpordiscapacidad, y.exoneracionportercerasedad, y.valorimpret403, y.valorimpasumido405, y.baseimponiblegrav, y.documentno, y.ruccontador FROM (SELECT get_uuid() AS sspr_formulary107_detail_v_id, to_char('0') AS ad_client_id, to_char('0') AS ad_org_id, now() AS created, to_char('100') AS createdby, now() AS updated, to_char('100') AS updatedby, to_char('Y') AS isactive, x.anio_entrega, x.mes_entrega, x.dia_entrega, x.taxid_org, x.org, x.year, x.c_year_id, x.c_bpartner_id, x.taxid_employee, x.empleado, x.tipoidentificacion, x.numeroidentificacion, x.empleadoapellido, x.empleadonombre, x.codigoestab, x.pais, x.codigopais, to_char(CASE WHEN x.aplicaconvenio = 'NO' THEN 'NA' ELSE x.aplicaconvenio END) AS aplicaconvenio, to_char(CASE WHEN x.discapacitado = 'SI' THEN '02' ELSE '01' END) AS discapacitado, to_char(COALESCE(x.porcentajediscapacidad, '0')) AS porcentajediscapacidad, to_char(COALESCE(x.tipoidentdiscapacidad, 'N')) AS tipoidentdiscapacidad, to_char(COALESCE(x.numeroidentifdiscapacidad, '999')) AS numeroidentifdiscapacidad, round(COALESCE(sum(x.sueldo), 0.00), 2) AS sueldo, round(COALESCE(sum(x.bonos), 0.00), 2) AS bonos, round(COALESCE(sum(x.utilidades), 0.00), 2) AS utilidades, 0.00 AS impuestorenta, round(COALESCE(sum(x.decimotercero), 0.00), 2) AS decimotercero, round(COALESCE(sum(x.decimocuarto), 0.00), 2) AS decimocuarto, round(COALESCE(sum(x.fondosreserva), 0.00), 2) AS fondosreserva, round(COALESCE(sum(x.compensacionsalariodigno), 0.00), 2) AS compensacionsalariodigno, round(COALESCE(sum(x.otrosing_rentagravada), 0.00), 2) AS otrosing_rentagravada, COALESCE(sum(round(x.sueldo, 2)), 0.00) + COALESCE(sum(round(x.bonos, 2)), 0.00) + COALESCE(sum(round(x.utilidades, 2)), 0.00) + COALESCE(sum(round(x.impuestorenta, 2)), 0.00) AS ingresosgrav349, COALESCE(x.sistemasalariodigno, 0) AS sistemasalariodigno, round(COALESCE(sum(x.aportepersonal), 0.00), 2) AS aportepersonal, round(a.taxamount + (COALESCE(CASE WHEN round(round(COALESCE(sum(x.sueldo), 0.00), 2) + round(COALESCE(sum(x.bonos), 0.00), 2) + round(COALESCE(sum(x.utilidades), 0.00), 2) + round(COALESCE(sum(x.ingresosgravados), 0.00), 2) - round(COALESCE(sum(x.aportepersonal), 0.00), 2) - round(COALESCE(sum(x.aportepersonalo), 0.00), 2) - round(COALESCE(sum(x.gastosvivienda), 0.00), 2) - round(COALESCE(sum(x.gastossalud), 0.00), 2) - round(COALESCE(sum(x.gastoseducacion), 0.00), 2) - round(COALESCE(sum(x.gastoalimentacion), 0.00), 2) - round(COALESCE(sum(x.gastosvestimenta), 0.00), 2) - round(COALESCE(sum(x.exoneracionpordiscapacidad), 0.00), 2) - round(COALESCE(sum(x.exoneracionportercerasedad), 0.00), 2) + round(COALESCE(sum(x.impuestorenta), 0.00), 2), 2) < 0 THEN 0.00 ELSE round(round(COALESCE(sum(x.sueldo), 0.00), 2) + round(COALESCE(sum(x.bonos), 0.00), 2) + round(COALESCE(sum(x.utilidades), 0.00), 2) + round(COALESCE(sum(x.ingresosgravados), 0.00), 2) - round(COALESCE(sum(x.aportepersonal), 0.00), 2) - round(COALESCE(sum(x.aportepersonalo), 0.00), 2) - round(COALESCE(sum(x.gastosvivienda), 0.00), 2) - round(COALESCE(sum(x.gastossalud), 0.00), 2) - round(COALESCE(sum(x.gastoseducacion), 0.00), 2) - round(COALESCE(sum(x.gastoalimentacion), 0.00), 2) - round(COALESCE(sum(x.gastosvestimenta), 0.00), 2) - round(COALESCE(sum(x.exoneracionpordiscapacidad), 0.00), 2) - round(COALESCE(sum(x.exoneracionportercerasedad), 0.00), 2) + round(COALESCE(sum(x.impuestorenta), 0.00), 2), 2) END, 0.00) - a.basemin) * (a.percentajetax / 100), 2) AS impuestorentacausado, round(COALESCE(sum(x.valorimprettrabajador), 0.00), 2) AS valorimprettrabajador, round(COALESCE(sum(x.gastosvivienda), 0.00), 2) AS gastosvivienda, round(COALESCE(sum(x.gastossalud), 0.00), 2) AS gastossalud, round(COALESCE(sum(x.gastoseducacion), 0.00), 2) AS gastoseducacion, round(COALESCE(sum(x.gastoalimentacion), 0.00), 2) AS gastoalimentacion, round(COALESCE(sum(x.gastosvestimenta), 0.00), 2) AS gastosvestimenta, round(COALESCE(sum(x.ingresosgravados), 0.00), 2) AS ingresosgravados, round(COALESCE(sum(x.aportepersonalo), 0.00), 2) AS aportepersonalo, round(COALESCE(sum(x.exoneracionpordiscapacidad), 0.00), 2) AS exoneracionpordiscapacidad, round(COALESCE(sum(x.exoneracionportercerasedad), 0.00), 2) AS exoneracionportercerasedad, round(COALESCE(sum(x.valorimpret403), 0.00), 2) AS valorimpret403, 0.00 AS valorimpasumido405, CASE WHEN round(round(COALESCE(sum(x.sueldo), 0.00), 2) + round(COALESCE(sum(x.bonos), 0.00), 2) + round(COALESCE(sum(x.utilidades), 0.00), 2) + round(COALESCE(sum(x.ingresosgravados), 0.00), 2) - round(COALESCE(sum(x.aportepersonal), 0.00), 2) - round(COALESCE(sum(x.aportepersonalo), 0.00), 2) - round(COALESCE(sum(x.gastosvivienda), 0.00), 2) - round(COALESCE(sum(x.gastossalud), 0.00), 2) - round(COALESCE(sum(x.gastoseducacion), 0.00), 2) - round(COALESCE(sum(x.gastoalimentacion), 0.00), 2) - round(COALESCE(sum(x.gastosvestimenta), 0.00), 2) - round(COALESCE(sum(x.exoneracionpordiscapacidad), 0.00), 2) - round(COALESCE(sum(x.exoneracionportercerasedad), 0.00), 2) + round(COALESCE(sum(x.impuestorenta), 0.00), 2), 2) < 0 THEN 0.00 ELSE round(round(COALESCE(sum(x.sueldo), 0.00), 2) + round(COALESCE(sum(x.bonos), 0.00), 2) + round(COALESCE(sum(x.utilidades), 0.00), 2) + round(COALESCE(sum(x.ingresosgravados), 0.00), 2) - round(COALESCE(sum(x.aportepersonal), 0.00), 2) - round(COALESCE(sum(x.aportepersonalo), 0.00), 2) - round(COALESCE(sum(x.gastosvivienda), 0.00), 2) - round(COALESCE(sum(x.gastossalud), 0.00), 2) - round(COALESCE(sum(x.gastoseducacion), 0.00), 2) - round(COALESCE(sum(x.gastoalimentacion), 0.00), 2) - round(COALESCE(sum(x.gastosvestimenta), 0.00), 2) - round(COALESCE(sum(x.exoneracionpordiscapacidad), 0.00), 2) - round(COALESCE(sum(x.exoneracionportercerasedad), 0.00), 2) + round(COALESCE(sum(x.impuestorenta), 0.00), 2), 2) END AS baseimponiblegrav, (x.year || ' - ') || x.taxid_employee AS documentno, x.ruccontador FROM (SELECT 'form107' AS id, to_char(now(), 'yyyy') AS anio_entrega, to_char(now(), 'MM') AS mes_entrega, to_char(now(), 'dd') AS dia_entrega, a_1.taxid_org, a_1.org, a_1.year, a_1.c_year_id, a_1.c_bpartner_id, a_1.taxid_employee, a_1.empleado, a_1.tipoidentificacion, a_1.numeroidentificacion, a_1.empleadoapellido, a_1.empleadonombre, a_1.codigoestab, a_1.pais, a_1.codigopais, a_1.aplicaconvenio, a_1.discapacitado, a_1.porcentajediscapacidad, a_1.tipoidentdiscapacidad, a_1.numeroidentifdiscapacidad, sum(a_1.sueldo) AS sueldo, sum(a_1.bonos) AS bonos, sum(a_1.utilidades) AS utilidades, sum(a_1.impuestorenta) AS impuestorenta, sum(a_1.decimotercero) AS decimotercero, sum(a_1.decimocuarto) AS decimocuarto, sum(a_1.fondosreserva) AS fondosreserva, sum(a_1.compensacionsalariodigno) AS compensacionsalariodigno, sum(a_1.otrosing_rentagravada) AS otrosing_rentagravada, a_1.sistemasalariodigno, sum(a_1.aportepersonal) AS aportepersonal, sum(a_1.impuestorentacausado) AS impuestorentacausado, sum(a_1.valorimprettrabajador) AS valorimprettrabajador, 0.00 AS gastosvivienda, 0.00 AS gastossalud, 0.00 AS gastoseducacion, 0.00 AS gastoalimentacion, 0.00 AS gastosvestimenta, 0.00 AS ingresosgravados, 0.00 AS aportepersonalo, a_1.exoneracionpordiscapacidad, a_1.exoneracionportercerasedad, 0.00 AS valorimpret403, 0.00 AS valorimpasumido405, a_1.ruccontador FROM sspr_formulary107_v a_1 GROUP BY a_1.taxid_org, a_1.org, a_1.year, a_1.tipoidentificacion, a_1.numeroidentificacion, a_1.empleado, a_1.empleadoapellido, a_1.empleadonombre, a_1.taxid_employee, a_1.codigoestab, a_1.pais, a_1.codigopais, a_1.aplicaconvenio, a_1.discapacitado, a_1.porcentajediscapacidad, a_1.tipoidentdiscapacidad, a_1.numeroidentifdiscapacidad, a_1.c_year_id, a_1.c_bpartner_id, a_1.sistemasalariodigno, a_1.ruccontador, a_1.exoneracionpordiscapacidad, a_1.exoneracionportercerasedad UNION ALL SELECT 'gastos' AS id, to_char(now(), 'yyyy') AS anio_entrega, to_char(now(), 'MM') AS mes_entrega, to_char(now(), 'dd') AS dia_entrega, b_1.taxid_org, b_1.org, b_1.year, b_1.c_year_id, b_1.c_bpartner_id, b_1.taxid_employee, b_1.empleado, b_1.tipoidentificacion, b_1.numeroidentificacion, b_1.empleadoapellido, b_1.empleadonombre, b_1.codigoestab, b_1.pais, b_1.codigopais, b_1.aplicaconvenio, b_1.discapacitado, b_1.porcentajediscapacidad, b_1.tipoidentdiscapacidad, b_1.numeroidentifdiscapacidad, 0.00 AS sueldo, 0.00 AS bonos, 0.00 AS utilidades, 0.00 AS impuestorenta, 0.00 AS decimotercero, 0.00 AS decimocuarto, 0.00 AS fondosreserva, 0.00 AS compensacionsalariodigno, 0.00 AS otrosing_rentagravada, 1 AS sistemasalariodigno, 0.00 AS aportepersonal, 0.00 AS impuestorentacausado, 0.00 AS valorimprettrabajador, COALESCE(sum(b_1.gastosvivienda), 0.00) AS gastosvivienda, COALESCE(sum(b_1.gastossalud), 0.00) AS gastossalud, COALESCE(sum(b_1.gastoseducacion), 0.00) AS gastoseducacion, COALESCE(sum(b_1.gastoalimentacion), 0.00) AS gastoalimentacion, COALESCE(sum(b_1.gastosvestimenta), 0.00) AS gastosvestimenta, 0.00 AS ingresosgravados, 0.00 AS aportepersonalo, 0.00 AS exoneracionpordiscapacidad, 0.00 AS exoneracionportercerasedad, 0.00 AS valorimpret403, 0.00 AS valorimpasumido405, b_1.ruccontador FROM sspr_costemployee_v b_1 GROUP BY b_1.c_year_id, b_1.c_bpartner_id, b_1.year, b_1.empleado, b_1.taxid_org, b_1.org, b_1.taxid_employee, b_1.tipoidentificacion, b_1.numeroidentificacion, b_1.empleadonombre, b_1.codigoestab, b_1.pais, b_1.codigopais, b_1.aplicaconvenio, b_1.discapacitado, b_1.porcentajediscapacidad, b_1.tipoidentdiscapacidad, b_1.numeroidentifdiscapacidad, b_1.empleadoapellido, b_1.ruccontador UNION ALL SELECT 'Liquidacion decimos' AS id, to_char(now(), 'yyyy') AS anio_entrega, to_char(now(), 'MM') AS mes_entrega, to_char(now(), 'dd') AS dia_entrega, b_1.taxid_org, b_1.org, b_1.year, b_1.c_year_id, b_1.c_bpartner_id, b_1.taxid_employee, b_1.empleado, b_1.tipoidentificacion, b_1.numeroidentificacion, b_1.empleadoapellido, b_1.empleadonombre, b_1.codigoestab, b_1.pais, b_1.codigopais, b_1.aplicaconvenio, b_1.discapacitado, b_1.porcentajediscapacidad, b_1.tipoidentdiscapacidad, b_1.numeroidentifdiscapacidad, 0.00 AS sueldo, 0.00 AS bonos, 0.00 AS utilidades, 0.00 AS impuestorenta, sum(b_1.decimotercero) AS decimotercero, sum(b_1.decimocuarto) AS decimocuarto, 0.00 AS fondosreserva, 0.00 AS compensacionsalariodigno, 0.00 AS otrosing_rentagravada, 1 AS sistemasalariodigno, 0.00 AS aportepersonal, 0.00 AS impuestorentacausado, 0.00 AS valorimprettrabajador, 0.00 AS gastosvivienda, 0.00 AS gastossalud, 0.00 AS gastoseducacion, 0.00 AS gastoalimentacion, 0.00 AS gastosvestimenta, 0.00 AS ingresosgravados, 0.00 AS aportepersonalo, 0.00 AS exoneracionpordiscapacidad, 0.00 AS exoneracionportercerasedad, 0.00 AS valorimpret403, 0.00 AS valorimpasumido405, b_1.ruccontador FROM sspr_tenth_settlement_v b_1 GROUP BY b_1.c_year_id, b_1.c_bpartner_id, b_1.year, b_1.empleado, b_1.taxid_org, b_1.org, b_1.taxid_employee, b_1.tipoidentificacion, b_1.numeroidentificacion, b_1.empleadonombre, b_1.codigoestab, b_1.pais, b_1.codigopais, b_1.aplicaconvenio, b_1.discapacitado, b_1.porcentajediscapacidad, b_1.tipoidentdiscapacidad, b_1.numeroidentifdiscapacidad, b_1.empleadoapellido, b_1.ruccontador UNION ALL SELECT 'datosadicionales' AS id, to_char(now(), 'yyyy') AS anio_entrega, to_char(now(), 'MM') AS mes_entrega, to_char(now(), 'dd') AS dia_entrega, c.taxid_org, c.org, c.year, c.c_year_id, c.c_bpartner_id, c.taxid_employee, c.empleado, c.tipoidentificacion, c.numeroidentificacion, c.empleadoapellido, c.empleadonombre, c.codigoestab, c.pais, c.codigopais, c.aplicaconvenio, c.discapacitado, c.porcentajediscapacidad, c.tipoidentdiscapacidad, c.numeroidentifdiscapacidad, 0.00 AS sueldo, 0.00 AS bonos, 0.00 AS utilidades, 0.00 AS impuestorenta, 0.00 AS decimotercero, 0.00 AS decimocuarto, 0.00 AS fondosreserva, 0.00 AS compensacionsalariodigno, 0.00 AS otrosing_rentagravada, 1 AS sistemasalariodigno, 0.00 AS aportepersonal, 0.00 AS impuestorentacausado, 0.00 AS valorimprettrabajador, 0.00 AS gastosvivienda, 0.00 AS gastossalud, 0.00 AS gastoseducacion, 0.00 AS gastoalimentacion, 0.00 AS gastosvestimenta, sum(c.ingresosgravados) AS ingresosgravados, sum(c.aportepersonalo) AS aportepersonalo, sum(c.exoneracionpordiscapacidad) AS exoneracionpordiscapacidad, sum(c.exoneracionportercerasedad) AS exoneracionportercerasedad, sum(c.valorimpret403) AS valorimpret403, sum(c.valorimpasumido405) AS valorimpasumido405, c.ruccontador FROM sspr_dataformulary107_v c GROUP BY c.c_year_id, c.c_bpartner_id, c.year, c.empleado, c.taxid_org, c.org, c.taxid_employee, c.tipoidentificacion, c.numeroidentificacion, c.empleadoapellido, c.empleadonombre, c.codigoestab, c.pais, c.codigopais, c.aplicaconvenio, c.discapacitado, c.porcentajediscapacidad, c.tipoidentdiscapacidad, c.numeroidentifdiscapacidad, c.ruccontador UNION ALL SELECT 'liquidaciones' AS id, to_char(now(), 'yyyy') AS anio_entrega, to_char(now(), 'MM') AS mes_entrega, to_char(now(), 'dd') AS dia_entrega, a_1.taxid_org, a_1.org, a_1.year, a_1.c_year_id, a_1.c_bpartner_id, a_1.taxid_employee, a_1.empleado, a_1.tipoidentificacion, a_1.numeroidentificacion, a_1.empleadoapellido, a_1.empleadonombre, a_1.codigoestab, a_1.pais, a_1.codigopais, a_1.aplicaconvenio, a_1.discapacitado, a_1.porcentajediscapacidad, a_1.tipoidentdiscapacidad, a_1.numeroidentifdiscapacidad, sum(a_1.sueldo) AS sueldo, sum(a_1.bonos) AS bonos, 0.00 AS utilidades, sum(a_1.impuestorenta) AS impuestorenta, sum(a_1.decimotercero) AS decimotercero, sum(a_1.decimocuarto) AS decimocuarto, sum(a_1.fondosreserva) AS fondosreserva, 0.00 AS compensacionsalariodigno, sum(a_1.otrosing_rentagravada) AS otrosing_rentagravada, 1 AS sistemasalariodigno, sum(a_1.aportepersonal) AS aportepersonal, 0.00 AS impuestorentacausado, sum(a_1.valorimprettrabajador) AS valorimprettrabajador, 0.00 AS gastosvivienda, 0.00 AS gastossalud, 0.00 AS gastoseducacion, 0.00 AS gastoalimentacion, 0.00 AS gastosvestimenta, 0.00 AS ingresosgravados, 0.00 AS aportepersonalo, 0.00 AS exoneracionpordiscapacidad, 0.00 AS exoneracionportercerasedad, 0.00 AS valorimpret403, 0.00 AS valorimpasumido405, a_1.ruccontador FROM sspr_settlement_v a_1 GROUP BY a_1.year, a_1.c_year_id, a_1.c_bpartner_id, a_1.taxid_employee, a_1.empleado, a_1.taxid_org, a_1.org, a_1.tipoidentificacion, a_1.numeroidentificacion, a_1.empleadoapellido, a_1.empleadonombre, a_1.codigoestab, a_1.pais, a_1.codigopais, a_1.aplicaconvenio, a_1.discapacitado, a_1.porcentajediscapacidad, a_1.tipoidentdiscapacidad, a_1.numeroidentifdiscapacidad, a_1.ruccontador UNION ALL SELECT 'utilidades' AS id, to_char(now(), 'yyyy') AS anio_entrega, to_char(now(), 'MM') AS mes_entrega, to_char(now(), 'dd') AS dia_entrega, c.taxid_org, c.org, c.year, c.c_year_id, c.c_bpartner_id, c.taxid_employee, c.empleado, c.tipoidentificacion, c.numeroidentificacion, c.empleadoapellido, c.empleadonombre, c.codigoestab, c.pais, c.codigopais, c.aplicaconvenio, c.discapacitado, c.porcentajediscapacidad, c.tipoidentdiscapacidad, c.numeroidentifdiscapacidad, 0.00 AS sueldo, 0.00 AS bonos, sum(c.utilidades) AS utilidades, 0.00 AS impuestorenta, 0.00 AS decimotercero, 0.00 AS decimocuarto, 0.00 AS fondosreserva, 0.00 AS compensacionsalariodigno, 0.00 AS otrosing_rentagravada, 1 AS sistemasalariodigno, 0.00 AS aportepersonal, 0.00 AS impuestorentacausado, 0.00 AS valorimprettrabajador, 0.00 AS gastosvivienda, 0.00 AS gastossalud, 0.00 AS gastoseducacion, 0.00 AS gastoalimentacion, 0.00 AS gastosvestimenta, 0.00 AS ingresosgravados, 0.00 AS aportepersonalo, 0.00 AS exoneracionpordiscapacidad, 0.00 AS exoneracionportercerasedad, 0.00 AS valorimpret403, 0.00 AS valorimpasumido405, c.ruccontador FROM sspr_utilityemployee_v c GROUP BY c.c_year_id, c.c_bpartner_id, c.year, c.empleado, c.taxid_org, c.org, c.taxid_employee, c.tipoidentificacion, c.numeroidentificacion, c.empleadoapellido, c.empleadonombre, c.codigoestab, c.pais, c.codigopais, c.aplicaconvenio, c.discapacitado, c.porcentajediscapacidad, c.tipoidentdiscapacidad, c.numeroidentifdiscapacidad, c.ruccontador) x LEFT JOIN sspr_incometax b ON b.c_year_id = x.c_year_id LEFT JOIN sspr_incometaxline a ON a.sspr_incometax_id = b.sspr_incometax_id GROUP BY x.anio_entrega, x.mes_entrega, x.dia_entrega, x.taxid_org, x.org, x.year, x.c_year_id, x.c_bpartner_id, x.taxid_employee, x.empleado, x.tipoidentificacion, x.numeroidentificacion, x.empleadoapellido, x.empleadonombre, x.codigoestab, x.pais, x.codigopais, x.aplicaconvenio, x.discapacitado, x.porcentajediscapacidad, x.tipoidentdiscapacidad, x.numeroidentifdiscapacidad, x.sistemasalariodigno, x.ruccontador, b.c_year_id, a.basemax, a.basemin, a.taxamount, a.percentajetax HAVING COALESCE(CASE WHEN round(round(COALESCE(sum(x.sueldo), 0.00), 2) + round(COALESCE(sum(x.bonos), 0.00), 2) + round(COALESCE(sum(x.utilidades), 0.00), 2) + round(COALESCE(sum(x.ingresosgravados), 0.00), 2) - round(COALESCE(sum(x.aportepersonal), 0.00), 2) - round(COALESCE(sum(x.aportepersonalo), 0.00), 2) - round(COALESCE(sum(x.gastosvivienda), 0.00), 2) - round(COALESCE(sum(x.gastossalud), 0.00), 2) - round(COALESCE(sum(x.gastoseducacion), 0.00), 2) - round(COALESCE(sum(x.gastoalimentacion), 0.00), 2) - round(COALESCE(sum(x.gastosvestimenta), 0.00), 2) - round(COALESCE(sum(x.exoneracionpordiscapacidad), 0.00), 2) - round(COALESCE(sum(x.exoneracionportercerasedad), 0.00), 2) + round(COALESCE(sum(x.impuestorenta), 0.00), 2), 2) < 0 THEN 0.00 ELSE round(round(COALESCE(sum(x.sueldo), 0.00), 2) + round(COALESCE(sum(x.bonos), 0.00), 2) + round(COALESCE(sum(x.utilidades), 0.00), 2) + round(COALESCE(sum(x.ingresosgravados), 0.00), 2) - round(COALESCE(sum(x.aportepersonal), 0.00), 2) - round(COALESCE(sum(x.aportepersonalo), 0.00), 2) - round(COALESCE(sum(x.gastosvivienda), 0.00), 2) - round(COALESCE(sum(x.gastossalud), 0.00), 2) - round(COALESCE(sum(x.gastoseducacion), 0.00), 2) - round(COALESCE(sum(x.gastoalimentacion), 0.00), 2) - round(COALESCE(sum(x.gastosvestimenta), 0.00), 2) - round(COALESCE(sum(x.exoneracionpordiscapacidad), 0.00), 2) - round(COALESCE(sum(x.exoneracionportercerasedad), 0.00), 2) + round(COALESCE(sum(x.impuestorenta), 0.00), 2), 2) END, 0.00) >= a.basemin AND COALESCE(CASE WHEN round(round(COALESCE(sum(x.sueldo), 0.00), 2) + round(COALESCE(sum(x.bonos), 0.00), 2) + round(COALESCE(sum(x.utilidades), 0.00), 2) + round(COALESCE(sum(x.ingresosgravados), 0.00), 2) - round(COALESCE(sum(x.aportepersonal), 0.00), 2) - round(COALESCE(sum(x.aportepersonalo), 0.00), 2) - round(COALESCE(sum(x.gastosvivienda), 0.00), 2) - round(COALESCE(sum(x.gastossalud), 0.00), 2) - round(COALESCE(sum(x.gastoseducacion), 0.00), 2) - round(COALESCE(sum(x.gastoalimentacion), 0.00), 2) - round(COALESCE(sum(x.gastosvestimenta), 0.00), 2) - round(COALESCE(sum(x.exoneracionpordiscapacidad), 0.00), 2) - round(COALESCE(sum(x.exoneracionportercerasedad), 0.00), 2) + round(COALESCE(sum(x.impuestorenta), 0.00), 2), 2) < 0 THEN 0.00 ELSE round(round(COALESCE(sum(x.sueldo), 0.00), 2) + round(COALESCE(sum(x.bonos), 0.00), 2) + round(COALESCE(sum(x.utilidades), 0.00), 2) + round(COALESCE(sum(x.ingresosgravados), 0.00), 2) - round(COALESCE(sum(x.aportepersonal), 0.00), 2) - round(COALESCE(sum(x.aportepersonalo), 0.00), 2) - round(COALESCE(sum(x.gastosvivienda), 0.00), 2) - round(COALESCE(sum(x.gastossalud), 0.00), 2) - round(COALESCE(sum(x.gastoseducacion), 0.00), 2) - round(COALESCE(sum(x.gastoalimentacion), 0.00), 2) - round(COALESCE(sum(x.gastosvestimenta), 0.00), 2) - round(COALESCE(sum(x.exoneracionpordiscapacidad), 0.00), 2) - round(COALESCE(sum(x.exoneracionportercerasedad), 0.00), 2) + round(COALESCE(sum(x.impuestorenta), 0.00), 2), 2) END, 0.00) <= a.basemax ORDER BY x.year, x.empleado) y ORDER BY y.year, y.empleado]]></view>
  </database>
