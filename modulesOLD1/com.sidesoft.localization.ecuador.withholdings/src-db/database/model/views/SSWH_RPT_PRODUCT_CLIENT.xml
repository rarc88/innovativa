<?xml version="1.0"?>
  <database name="VIEW SSWH_RPT_PRODUCT_CLIENT">
    <view name="SSWH_RPT_PRODUCT_CLIENT"><![CDATA[SELECT b.name AS cliente, p.name AS producto, l.priceactual AS precio, c.dateinvoiced AS fecha, CASE WHEN d.name = 'NDebito Cheq. Protestado' THEN l.qtyinvoiced * (-1) WHEN d.name = 'Factura de Venta' THEN l.qtyinvoiced WHEN d.docbasetype = 'ARC' THEN l.qtyinvoiced * (-1) ELSE l.qtyinvoiced END AS cantidad, l.priceactual * CASE WHEN d.name = 'NDebito Cheq. Protestado' THEN l.qtyinvoiced * (-1) WHEN d.name = 'Factura de Venta' THEN l.qtyinvoiced WHEN d.docbasetype = 'ARC' THEN l.qtyinvoiced * (-1) ELSE l.qtyinvoiced END AS total, c.poreference AS nofactura FROM c_bpartner b LEFT JOIN c_invoice c ON b.c_bpartner_id = c.c_bpartner_id LEFT JOIN c_invoiceline l ON c.c_invoice_id = l.c_invoice_id LEFT JOIN m_product p ON l.m_product_id = p.m_product_id LEFT JOIN c_doctype d ON d.c_doctype_id = c.c_doctype_id WHERE d.docbasetype IN ('ARI', 'ARC') ORDER BY b.name, c.dateinvoiced]]></view>
  </database>
