<?xml version="1.0"?>
  <database name="VIEW SSWH_SALES_VOIDED_NATS">
    <view name="SSWH_SALES_VOIDED_NATS"><![CDATA[(SELECT CASE c.em_sswh_taxidtype WHEN 'R' THEN '04' WHEN 'P' THEN '06' WHEN 'D' THEN '05' WHEN 'C' THEN '07' ELSE NULL END AS tipo_identificador, substr(a.documentno, 0, 3) AS establecimiento, substr(a.documentno, 5, 3) AS punto_emision, to_char(au.numberfrom) AS secuencia_ini, to_char(au.numberto) AS secuencia_fin, to_char(au.authorizationno) AS autorization, to_char(a.dateinvoiced, 'DD/MM/YYYY') AS dateinvoiced, to_char(a.dateacct, 'DD/MM/YYYY') AS dateacct, a.posted, a.ad_org_id FROM c_invoice a LEFT JOIN c_bpartner c ON a.c_bpartner_id = c.c_bpartner_id LEFT JOIN c_doctype g ON a.c_doctype_id = g.c_doctype_id LEFT JOIN sswh_authorization au ON g.c_doctype_id = au.c_doctype_id AND a.dateinvoiced >= au.datefrom AND a.dateinvoiced <= au.dateto WHERE a.issotrx = 'Y' AND a.processed = 'Y' AND a.docstatus = 'VO' AND g.docbasetype = 'ARI' AND g.isreversal = 'N' GROUP BY c.em_sswh_taxidtype, a.documentno, a.dateinvoiced, au.numberfrom, au.numberto, au.authorizationno, a.dateacct, a.posted, a.ad_org_id UNION ALL SELECT CASE c.em_sswh_taxidtype WHEN 'R' THEN '04' WHEN 'P' THEN '06' WHEN 'D' THEN '05' WHEN 'C' THEN '07' ELSE NULL END AS tipo_identificador, substr(a.documentno, 0, 3) AS establecimiento, substr(a.documentno, 5, 3) AS punto_emision, to_char(au.numberfrom) AS secuencia_ini, to_char(au.numberto) AS secuencia_fin, to_char(au.authorizationno) AS autorization, to_char(a.dateinvoiced, 'DD/MM/YYYY') AS dateinvoiced, to_char(a.dateacct, 'DD/MM/YYYY') AS dateacct, a.posted, a.ad_org_id FROM c_invoice a LEFT JOIN c_bpartner c ON a.c_bpartner_id = c.c_bpartner_id LEFT JOIN c_doctype g ON a.c_doctype_id = g.c_doctype_id LEFT JOIN sswh_authorization au ON g.c_doctype_id = au.c_doctype_id AND a.dateinvoiced >= au.datefrom AND a.dateinvoiced <= au.dateto WHERE a.issotrx = 'Y' AND a.processed = 'Y' AND a.docstatus = 'VO' AND ((g.docbasetype IN ('ARI_RM', 'ARC')) OR g.isreversal = 'Y') GROUP BY c.em_sswh_taxidtype, a.documentno, a.dateinvoiced, au.numberfrom, au.numberto, au.authorizationno, a.dateacct, a.posted, a.ad_org_id) UNION ALL SELECT CASE c.em_sswh_taxidtype WHEN 'R' THEN '04' WHEN 'P' THEN '06' WHEN 'D' THEN '05' WHEN 'C' THEN '07' ELSE NULL END AS tipo_identificador, substr(a.documentno, 0, 3) AS establecimiento, substr(a.documentno, 5, 3) AS punto_emision, to_char(au.numberfrom) AS secuencia_ini, to_char(au.numberto) AS secuencia_fin, to_char(au.authorizationno) AS autorization, to_char(a.dateinvoiced, 'DD/MM/YYYY') AS dateinvoiced, to_char(a.dateacct, 'DD/MM/YYYY') AS dateacct, a.posted, a.ad_org_id FROM c_invoice a LEFT JOIN c_bpartner c ON a.c_bpartner_id = c.c_bpartner_id LEFT JOIN c_doctype g ON a.c_doctype_id = g.c_doctype_id LEFT JOIN sswh_authorization au ON g.c_doctype_id = au.c_doctype_id AND a.dateinvoiced >= au.datefrom AND a.dateinvoiced <= au.dateto WHERE a.issotrx = 'Y' AND a.processed = 'Y' AND a.docstatus = 'VO' AND ((g.docbasetype IN ('ARI_RM', 'ARC')) OR g.isreversal = 'Y') GROUP BY c.em_sswh_taxidtype, a.documentno, au.authorizationno, a.dateinvoiced, au.numberfrom, au.numberto, a.dateacct, a.posted, a.ad_org_id]]></view>
  </database>
