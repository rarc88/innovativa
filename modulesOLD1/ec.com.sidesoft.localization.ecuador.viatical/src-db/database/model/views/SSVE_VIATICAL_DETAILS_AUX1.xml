<?xml version="1.0"?>
  <database name="VIEW SSVE_VIATICAL_DETAILS_AUX1">
    <view name="SSVE_VIATICAL_DETAILS_AUX1"><![CDATA[SELECT CASE WHEN val.sfb_budget_cert_line_id IS NULL THEN '' ELSE va.ssve_viatical_id END AS ssve_viatical_id, sum(CASE WHEN val.sfb_budget_cert_line_id IS NULL THEN 0 ELSE val.linenetamt END) AS totalamt_viatical, val.sfb_budget_cert_line_id FROM ssve_viatical va LEFT JOIN ssve_viaticalline val ON val.ssve_viatical_id = va.ssve_viatical_id WHERE val.linenetamt <> 0 AND va.processed = 'Y' GROUP BY va.ssve_viatical_id, val.sfb_budget_cert_line_id UNION ALL SELECT CASE WHEN vat.sfb_budget_cert_line_id IS NULL THEN '' ELSE va.ssve_viatical_id END AS ssve_viatical_id, sum(CASE WHEN vat.sfb_budget_cert_line_id IS NULL THEN 0 ELSE vat.linenetamt END) AS totalamt_viatical, vat.sfb_budget_cert_line_id FROM ssve_viatical va LEFT JOIN ssve_viatical_transp vat ON va.ssve_viatical_id = vat.ssve_viatical_id WHERE vat.linenetamt <> 0 AND va.processed = 'Y' AND vat.isrefundable = 'Y' GROUP BY va.ssve_viatical_id, vat.sfb_budget_cert_line_id UNION ALL SELECT CASE WHEN va.sfb_budget_cert_line_id IS NULL THEN '' ELSE va.ssve_viatical_id END AS ssve_viatical_id, CASE WHEN va.sfb_budget_cert_line_id IS NULL THEN 0 ELSE va.budgetadditfunds + va.budgetmobilamt + va.budgetfeedingamt END AS totalamt_viatical, va.sfb_budget_cert_line_id FROM ssve_viatical va WHERE (va.budgetadditfunds + va.budgetmobilamt + va.budgetfeedingamt) > 0 AND va.processed = 'Y']]></view>
  </database>
