<?xml version="1.0"?>
  <database name="TRIGGER SSACCT_CHECK_MATCHACCOUNT_TRG">
    <trigger name="SSACCT_CHECK_MATCHACCOUNT_TRG" table="FACT_ACCT" fires="after" insert="true" update="false" delete="false" foreach="row">
      <body><![CDATA[ 
 v_ACCOUNT_ID_DEPENDENT  VARCHAR(32);
 v_VALUE_ACCOUNT VARCHAR(40); 
BEGIN
    
  IF AD_isTriggerEnabled()='N' THEN RETURN;
  END IF;

  IF(INSERTING) THEN
    SELECT ACCOUNT_ID_DEPENDENT INTO v_ACCOUNT_ID_DEPENDENT FROM SSACCT_MATCH_ACCOUNTS WHERE ACCOUNT_ID_MAIN = :NEW.ACCOUNT_ID;
    IF (v_ACCOUNT_ID_DEPENDENT IS NULL) THEN
	  DELETE FROM FACT_ACCT FA WHERE FA.RECORD_ID = :NEW.RECORD_ID AND FA.AD_TABLE_ID = :NEW.AD_TABLE_ID;  
	  SELECT EV.VALUE INTO v_VALUE_ACCOUNT FROM C_ELEMENTVALUE EV WHERE EV.C_ELEMENTVALUE_ID = :NEW.ACCOUNT_ID;    
	  RAISE_APPLICATION_ERROR(-20000, 'Account no match');
	END IF;
  END IF;
  -- Deleting
    IF DELETING  THEN RETURN OLD; ELSE RETURN NEW; END IF; 
END SSACCT_CHECK_MATCHACCOUNT_TRG
]]></body>
    </trigger>
  </database>
